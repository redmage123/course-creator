{"version":3,"file":"PasswordChange-Ce34AIA4.js","sources":["../../src/pages/PasswordChange.tsx"],"sourcesContent":["/**\n * Password Change Page\n *\n * BUSINESS CONTEXT:\n * Allows authenticated users to change their password.\n * Requires current password for security verification.\n * Distinct from password reset flow (which uses token from email).\n *\n * TECHNICAL IMPLEMENTATION:\n * - Protected route (authenticated users only)\n * - Validates current password with backend\n * - Enforces password strength requirements\n * - Updates password securely\n */\n\nimport React, { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { DashboardLayout } from '../components/templates/DashboardLayout';\nimport { Card } from '../components/atoms/Card';\nimport { Button } from '../components/atoms/Button';\nimport { Heading } from '../components/atoms/Heading';\nimport { Input } from '../components/atoms/Input';\nimport { Spinner } from '../components/atoms/Spinner';\nimport { SEO } from '../components/common/SEO';\nimport { useAuth } from '../hooks/useAuth';\nimport { authService } from '../services';\nimport styles from './PasswordChange.module.css';\n\ninterface PasswordChangeForm {\n  current_password: string;\n  new_password: string;\n  confirm_password: string;\n}\n\ninterface FormErrors {\n  [key: string]: string;\n}\n\n/**\n * Password Change Page Component\n *\n * WHY THIS APPROACH:\n * - Security-first design (requires current password)\n * - Real-time validation feedback\n * - Clear password requirements shown\n * - Success/error messaging\n */\nexport const PasswordChange: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n\n  const [formData, setFormData] = useState<PasswordChangeForm>({\n    current_password: '',\n    new_password: '',\n    confirm_password: '',\n  });\n\n  const [errors, setErrors] = useState<FormErrors>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [submitSuccess, setSubmitSuccess] = useState(false);\n\n  /**\n   * Handle input changes\n   */\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n\n    setFormData(prev => ({\n      ...prev,\n      [name]: value,\n    }));\n\n    // Clear error for this field\n    if (errors[name]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[name];\n        return newErrors;\n      });\n    }\n  };\n\n  /**\n   * Validate form\n   */\n  const validateForm = (): boolean => {\n    const newErrors: FormErrors = {};\n\n    if (!formData.current_password) {\n      newErrors.current_password = 'Current password is required';\n    }\n\n    if (!formData.new_password) {\n      newErrors.new_password = 'New password is required';\n    } else if (formData.new_password.length < 8) {\n      newErrors.new_password = 'Password must be at least 8 characters';\n    } else if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/.test(formData.new_password)) {\n      newErrors.new_password = 'Password must contain uppercase, lowercase, and number';\n    }\n\n    if (formData.new_password === formData.current_password) {\n      newErrors.new_password = 'New password must be different from current password';\n    }\n\n    if (!formData.confirm_password) {\n      newErrors.confirm_password = 'Please confirm your new password';\n    } else if (formData.new_password !== formData.confirm_password) {\n      newErrors.confirm_password = 'Passwords do not match';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  /**\n   * Handle form submission\n   */\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      setSubmitError('Please fix the errors above');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setSubmitError(null);\n    setSubmitSuccess(false);\n\n    try {\n      await authService.changePassword({\n        current_password: formData.current_password,\n        new_password: formData.new_password,\n      });\n\n      setSubmitSuccess(true);\n\n      // Clear form\n      setFormData({\n        current_password: '',\n        new_password: '',\n        confirm_password: '',\n      });\n\n      // Redirect to dashboard after 2 seconds\n      setTimeout(() => {\n        navigate('/dashboard');\n      }, 2000);\n    } catch (error: any) {\n      console.error('Password change error:', error);\n\n      if (error.response?.status === 401) {\n        setSubmitError('Current password is incorrect');\n      } else if (error.response?.data?.detail) {\n        setSubmitError(error.response.data.detail);\n      } else if (error.response?.data?.message) {\n        setSubmitError(error.response.data.message);\n      } else {\n        setSubmitError('Failed to change password. Please try again.');\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const seoElement = (\n    <SEO\n      title=\"Change Password\"\n      description=\"Update your account password securely\"\n      keywords=\"change password, account security, update password\"\n    />\n  );\n\n  return (\n    <DashboardLayout seo={seoElement}>\n      <div className={styles.passwordChangeContainer}>\n        <Card className={styles.passwordChangeCard}>\n          <div className={styles.header}>\n            <Heading level={1} className={styles.title}>\n              Change Password\n            </Heading>\n            <p className={styles.subtitle}>\n              Update your password to keep your account secure\n            </p>\n          </div>\n\n          <form onSubmit={handleSubmit} className={styles.form}>\n            <Input\n              label=\"Current Password\"\n              type=\"password\"\n              name=\"current_password\"\n              value={formData.current_password}\n              onChange={handleInputChange}\n              error={errors.current_password}\n              required\n              placeholder=\"Enter your current password\"\n              autoComplete=\"current-password\"\n            />\n\n            <div className={styles.passwordRequirements}>\n              <Heading level={3} className={styles.requirementsTitle}>\n                New Password Requirements:\n              </Heading>\n              <ul className={styles.requirementsList}>\n                <li className={formData.new_password.length >= 8 ? styles.met : ''}>\n                  <i className={formData.new_password.length >= 8 ? 'fas fa-check-circle' : 'fas fa-circle'}></i>\n                  At least 8 characters\n                </li>\n                <li className={/[A-Z]/.test(formData.new_password) ? styles.met : ''}>\n                  <i className={/[A-Z]/.test(formData.new_password) ? 'fas fa-check-circle' : 'fas fa-circle'}></i>\n                  At least one uppercase letter\n                </li>\n                <li className={/[a-z]/.test(formData.new_password) ? styles.met : ''}>\n                  <i className={/[a-z]/.test(formData.new_password) ? 'fas fa-check-circle' : 'fas fa-circle'}></i>\n                  At least one lowercase letter\n                </li>\n                <li className={/\\d/.test(formData.new_password) ? styles.met : ''}>\n                  <i className={/\\d/.test(formData.new_password) ? 'fas fa-check-circle' : 'fas fa-circle'}></i>\n                  At least one number\n                </li>\n              </ul>\n            </div>\n\n            <Input\n              label=\"New Password\"\n              type=\"password\"\n              name=\"new_password\"\n              value={formData.new_password}\n              onChange={handleInputChange}\n              error={errors.new_password}\n              required\n              placeholder=\"Enter your new password\"\n              autoComplete=\"new-password\"\n            />\n\n            <Input\n              label=\"Confirm New Password\"\n              type=\"password\"\n              name=\"confirm_password\"\n              value={formData.confirm_password}\n              onChange={handleInputChange}\n              error={errors.confirm_password}\n              required\n              placeholder=\"Confirm your new password\"\n              autoComplete=\"new-password\"\n            />\n\n            {submitError && (\n              <div className={styles.submitError}>\n                <i className=\"fas fa-exclamation-circle\"></i>\n                {submitError}\n              </div>\n            )}\n\n            {submitSuccess && (\n              <div className={styles.submitSuccess}>\n                <i className=\"fas fa-check-circle\"></i>\n                Password changed successfully! Redirecting to dashboard...\n              </div>\n            )}\n\n            <div className={styles.actions}>\n              <Button\n                type=\"submit\"\n                variant=\"primary\"\n                size=\"large\"\n                disabled={isSubmitting || submitSuccess}\n                className={styles.submitButton}\n              >\n                {isSubmitting ? (\n                  <>\n                    <Spinner size=\"small\" />\n                    Changing Password...\n                  </>\n                ) : (\n                  <>\n                    <i className=\"fas fa-key\"></i>\n                    Change Password\n                  </>\n                )}\n              </Button>\n\n              <Link to=\"/dashboard\">\n                <Button variant=\"secondary\" size=\"large\" disabled={isSubmitting}>\n                  Cancel\n                </Button>\n              </Link>\n            </div>\n          </form>\n\n          <div className={styles.footer}>\n            <p className={styles.footerText}>\n              <i className=\"fas fa-info-circle\"></i>\n              Forgot your password? <Link to=\"/forgot-password\">Reset it here</Link>\n            </p>\n          </div>\n        </Card>\n      </div>\n    </DashboardLayout>\n  );\n};\n"],"names":["PasswordChange","navigate","useNavigate","useAuth","formData","setFormData","useState","errors","setErrors","isSubmitting","setIsSubmitting","submitError","setSubmitError","submitSuccess","setSubmitSuccess","handleInputChange","e","name","value","prev","newErrors","validateForm","handleSubmit","authService","error","seoElement","jsx","SEO","DashboardLayout","styles","jsxs","Card","Heading","Input","Button","Fragment","Spinner","Link"],"mappings":"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"}