import{j as e}from"./query-vendor-D-Supqfh.js";import{u as Y,h as Z,a as c}from"./react-vendor-DF6vRnOe.js";import{c as m,u as ee}from"./index-CGkn3TFZ.js";import"./state-vendor-CcNjB5Go.js";class se{async getCourses(t){const a=new URLSearchParams;t&&(t.organization_id&&a.append("organization_id",t.organization_id),t.track_id&&a.append("track_id",t.track_id),t.instructor_id&&a.append("instructor_id",t.instructor_id),t.difficulty_level&&a.append("difficulty_level",t.difficulty_level),t.category&&a.append("category",t.category),t.published_only!==void 0&&a.append("published_only",String(t.published_only)));const i=a.toString(),b=`/courses${i?`?${i}`:""}`;return await m.get(b)}async getCourseById(t){return await m.get(`/courses/${t}`)}async createCourse(t){return await m.post("/courses",t)}async updateCourse(t,a){return await m.put(`/courses/${t}`,a)}async deleteCourse(t){await m.delete(`/courses/${t}`)}async publishCourse(t){return await m.post(`/courses/${t}/publish`,{})}async unpublishCourse(t){return await m.post(`/courses/${t}/unpublish`,{})}async getCoursesByTrack(t){return this.getCourses({track_id:t})}async getCoursesByOrganization(t,a=!1){return this.getCourses({organization_id:t,published_only:a})}}const re=new se;class te{baseUrl="/api/v1/syllabus";async generateSyllabus(t){try{return await m.post(`${this.baseUrl}/generate`,t)}catch(a){throw this.transformError(a)}}async getGenerationProgress(t){try{return await m.get(`${this.baseUrl}/generate/progress/${t}`)}catch(a){throw this.transformError(a)}}validateUrl(t){if(!t||!t.trim())return{valid:!1,error:"URL cannot be empty"};const a=t.trim();if(!a.startsWith("http://")&&!a.startsWith("https://"))return{valid:!1,error:"URL must start with http:// or https://"};if(a.length>2048)return{valid:!1,error:"URL exceeds maximum length of 2048 characters"};try{new URL(a)}catch{return{valid:!1,error:"Invalid URL format"}}return{valid:!0}}validateUrls(t){const a=[];return t.length>10&&a.push("Maximum 10 URLs allowed"),t.forEach((i,b)=>{const o=this.validateUrl(i);o.valid||a.push(`URL ${b+1}: ${o.error}`)}),{valid:a.length===0,errors:a}}transformError(t){if(t instanceof Error){const a=t;if(a.response?.data?.detail){const i=a.response.data.detail;if(typeof i=="string")return new Error(i);if(Array.isArray(i)){const b=i.map(o=>`${o.loc.join(".")}: ${o.msg}`);return new Error(`Validation failed: ${b.join(", ")}`)}if(typeof i=="object"&&"message"in i)return new Error(i.message)}return t}return new Error("An unexpected error occurred")}hasExternalSources(t){return!!(t.source_url||t.source_urls&&t.source_urls.length>0||t.external_sources&&t.external_sources.length>0)}getAllSourceUrls(t){const a=[];return t.source_url&&a.push(t.source_url),t.source_urls&&a.push(...t.source_urls),t.external_sources&&t.external_sources.forEach(i=>{a.includes(i.url)||a.push(i.url)}),a}}const z=new te,ne="_container_1e3zn_5",ae="_header_1e3zn_11",oe="_subtitle_1e3zn_22",le="_form_1e3zn_27",ie="_section_1e3zn_34",ce="_formGroup_1e3zn_51",ue="_required_1e3zn_63",de="_charCount_1e3zn_92",pe="_helpText_1e3zn_100",he="_formRow_1e3zn_107",ge="_error_1e3zn_113",me="_tagInputContainer_1e3zn_123",_e="_addTagBtn_1e3zn_132",be="_tagsList_1e3zn_149",xe="_tag_1e3zn_123",fe="_removeTagBtn_1e3zn_167",ye="_actions_1e3zn_188",je="_cancelBtn_1e3zn_197",ve="_submitBtn_1e3zn_198",Ce="_sectionHeader_1e3zn_234",Ne="_toggleLabel_1e3zn_247",ze="_toggleCheckbox_1e3zn_256",we="_toggleSwitch_1e3zn_263",Se="_urlGenerationContent_1e3zn_294",Ue="_featureDescription_1e3zn_299",ke="_urlInputList_1e3zn_306",Le="_urlInputRow_1e3zn_312",Ee="_inputError_1e3zn_334",Be="_urlError_1e3zn_338",Re="_removeUrlBtn_1e3zn_346",Ge="_addUrlBtn_1e3zn_371",Ie="_generationOptions_1e3zn_396",Te="_checkboxLabel_1e3zn_403",De="_generateBtn_1e3zn_418",Pe="_progressContainer_1e3zn_447",Ae="_progressHeader_1e3zn_455",Fe="_progressStep_1e3zn_462",$e="_progressTime_1e3zn_468",He="_progressBar_1e3zn_473",Oe="_progressFill_1e3zn_480",Me="_progressDetails_1e3zn_487",We="_progressWarning_1e3zn_495",qe="_syllabusPreview_1e3zn_500",Ve="_syllabusContent_1e3zn_517",Ke="_syllabusHeader_1e3zn_521",Je="_syllabusLevel_1e3zn_528",Qe="_syllabusDescription_1e3zn_538",Xe="_syllabusObjectives_1e3zn_545",Ye="_syllabusModules_1e3zn_568",Ze="_moduleDescription_1e3zn_594",es="_syllabusSources_1e3zn_600",s={container:ne,header:ae,subtitle:oe,form:le,section:ie,formGroup:ce,required:ue,charCount:de,helpText:pe,formRow:he,error:ge,tagInputContainer:me,addTagBtn:_e,tagsList:be,tag:xe,removeTagBtn:fe,actions:ye,cancelBtn:je,submitBtn:ve,sectionHeader:Ce,toggleLabel:Ne,toggleCheckbox:ze,toggleSwitch:we,urlGenerationContent:Se,featureDescription:Ue,urlInputList:ke,urlInputRow:Le,inputError:Ee,urlError:Be,removeUrlBtn:Re,addUrlBtn:Ge,generationOptions:Ie,checkboxLabel:Te,generateBtn:De,progressContainer:Pe,progressHeader:Ae,progressStep:Fe,progressTime:$e,progressBar:He,progressFill:Oe,progressDetails:Me,progressWarning:We,syllabusPreview:qe,syllabusContent:Ve,syllabusHeader:Ke,syllabusLevel:Je,syllabusDescription:Qe,syllabusObjectives:Xe,syllabusModules:Ye,moduleDescription:Ze,syllabusSources:es},as=()=>{const j=Y(),[t]=Z(),{user:a}=ee(),i=t.get("track_id"),b=a?.organization_id,[o,C]=c.useState({title:"",description:"",category:"",difficulty_level:"beginner",estimated_duration:void 0,duration_unit:"weeks",price:0,tags:[],organization_id:b,track_id:i||void 0}),[N,k]=c.useState(""),[w,L]=c.useState(!1),[E,x]=c.useState(null),[B,F]=c.useState(!1),[h,S]=c.useState([""]),[y,U]=c.useState([]),[_,R]=c.useState(!1),[d,G]=c.useState(null),[u,I]=c.useState(null),[T,$]=c.useState(!0),[D,H]=c.useState(!0),p=c.useRef(null),O=["beginner","intermediate","advanced"],M=["hours","days","weeks","months"],f=r=>{const{name:n,value:l}=r.target;C(g=>({...g,[n]:n==="estimated_duration"||n==="price"?l?parseFloat(l):void 0:l}))},P=()=>{N.trim()&&!o.tags?.includes(N.trim())&&(C(r=>({...r,tags:[...r.tags||[],N.trim()]})),k(""))},W=r=>{C(n=>({...n,tags:n.tags?.filter(l=>l!==r)||[]}))},q=(r,n)=>{const l=[...h];l[r]=n,S(l);const g=[...y];if(n.trim()){const v=z.validateUrl(n);g[r]=v.error||""}else g[r]="";U(g)},V=()=>{h.length<10&&(S([...h,""]),U([...y,""]))},K=r=>{if(h.length>1){const n=h.filter((g,v)=>v!==r),l=y.filter((g,v)=>v!==r);S(n),U(l)}},A=c.useCallback(()=>h.filter(r=>{const n=r.trim();return n&&z.validateUrl(n).valid}),[h]);c.useEffect(()=>()=>{p.current&&clearInterval(p.current)},[]);const J=c.useCallback(r=>{p.current&&clearInterval(p.current),p.current=setInterval(async()=>{try{const n=await z.getGenerationProgress(r);n.success&&(G(n.progress),n.progress.generation_complete&&p.current&&(clearInterval(p.current),p.current=null))}catch(n){console.error("Progress polling error:",n)}},2e3)},[]),Q=async()=>{const r=A();if(r.length===0){x("Please enter at least one valid URL");return}if(!o.title.trim()){x("Please enter a course title before generating");return}R(!0),x(null),I(null),G(null);try{const n={title:o.title,description:o.description||"Training course generated from external documentation",level:o.difficulty_level,source_urls:r,use_rag_enhancement:T,include_code_examples:D},l=await z.generateSyllabus(n);l.request_id&&J(l.request_id),l.success&&l.syllabus?(I(l.syllabus),l.syllabus.description&&!o.description&&C(g=>({...g,description:l.syllabus.description}))):x(l.message||"Failed to generate syllabus")}catch(n){x(n instanceof Error?n.message:"Generation failed"),console.error("Syllabus generation error:",n)}finally{R(!1),p.current&&(clearInterval(p.current),p.current=null)}},X=async r=>{r.preventDefault(),L(!0),x(null);try{if(!o.title.trim())throw new Error("Course title is required");if(!o.description.trim())throw new Error("Course description is required");await re.createCourse(o),j(i?"/organization/tracks":"/dashboard/org-admin")}catch(n){x(n instanceof Error?n.message:"Failed to create course"),console.error("Course creation error:",n)}finally{L(!1)}};return e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{children:"Create New Course"}),e.jsx("p",{className:s.subtitle,children:i?"Add a new course to your learning track":"Create a standalone course"})]}),e.jsxs("form",{className:s.form,onSubmit:X,children:[E&&e.jsx("div",{className:s.error,role:"alert",children:E}),e.jsxs("section",{className:s.section,children:[e.jsx("h2",{children:"Basic Information"}),e.jsxs("div",{className:s.formGroup,children:[e.jsxs("label",{htmlFor:"title",children:["Course Title ",e.jsx("span",{className:s.required,children:"*"})]}),e.jsx("input",{type:"text",id:"title",name:"title",value:o.title,onChange:f,placeholder:"e.g., Introduction to Python Programming",required:!0,maxLength:200})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsxs("label",{htmlFor:"description",children:["Description ",e.jsx("span",{className:s.required,children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:o.description,onChange:f,placeholder:"Provide a detailed description of the course...",required:!0,maxLength:2e3,rows:5}),e.jsxs("span",{className:s.charCount,children:[o.description.length," / 2000"]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"category",children:"Category"}),e.jsx("input",{type:"text",id:"category",name:"category",value:o.category||"",onChange:f,placeholder:"e.g., Programming, Data Science, Business"})]})]}),e.jsxs("section",{className:s.section,children:[e.jsxs("div",{className:s.sectionHeader,children:[e.jsx("h2",{children:"AI-Powered Content Generation"}),e.jsxs("label",{className:s.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:B,onChange:r=>F(r.target.checked),className:s.toggleCheckbox}),e.jsx("span",{className:s.toggleSwitch}),"Generate from external documentation"]})]}),B&&e.jsxs("div",{className:s.urlGenerationContent,children:[e.jsx("p",{className:s.featureDescription,children:"Automatically generate course content by providing URLs to external documentation. Works with Salesforce docs, AWS documentation, internal wikis, and more."}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{children:"Documentation URLs"}),e.jsx("div",{className:s.urlInputList,children:h.map((r,n)=>e.jsxs("div",{className:s.urlInputRow,children:[e.jsx("input",{type:"url",value:r,onChange:l=>q(n,l.target.value),placeholder:"https://docs.example.com/guide",className:y[n]?s.inputError:"",disabled:_}),h.length>1&&e.jsx("button",{type:"button",onClick:()=>K(n),className:s.removeUrlBtn,disabled:_,"aria-label":"Remove URL",children:"×"}),y[n]&&e.jsx("span",{className:s.urlError,children:y[n]})]},n))}),h.length<10&&e.jsx("button",{type:"button",onClick:V,className:s.addUrlBtn,disabled:_,children:"+ Add another URL"}),e.jsx("span",{className:s.helpText,children:"Add up to 10 URLs. Supports HTTP/HTTPS documentation pages."})]}),e.jsxs("div",{className:s.generationOptions,children:[e.jsxs("label",{className:s.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:T,onChange:r=>$(r.target.checked),disabled:_}),"Use RAG enhancement for better context"]}),e.jsxs("label",{className:s.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:D,onChange:r=>H(r.target.checked),disabled:_}),"Include code examples from documentation"]})]}),e.jsx("button",{type:"button",onClick:Q,className:s.generateBtn,disabled:_||A().length===0||!o.title.trim(),children:_?"Generating...":"Generate Syllabus from URLs"}),_&&d&&e.jsxs("div",{className:s.progressContainer,children:[e.jsxs("div",{className:s.progressHeader,children:[e.jsx("span",{className:s.progressStep,children:d.current_step}),e.jsxs("span",{className:s.progressTime,children:[Math.round(d.elapsed_seconds),"s"]})]}),e.jsx("div",{className:s.progressBar,children:e.jsx("div",{className:s.progressFill,style:{width:`${Math.min((d.urls_fetched+d.chunks_ingested)/(d.total_urls*2+10)*100,95)}%`}})}),e.jsxs("div",{className:s.progressDetails,children:[e.jsxs("span",{children:["URLs: ",d.urls_fetched,"/",d.total_urls]}),d.urls_failed>0&&e.jsxs("span",{className:s.progressWarning,children:["(",d.urls_failed," failed)"]}),e.jsxs("span",{children:["Chunks: ",d.chunks_ingested]})]})]}),u&&e.jsxs("div",{className:s.syllabusPreview,children:[e.jsx("h3",{children:"Generated Syllabus Preview"}),e.jsxs("div",{className:s.syllabusContent,children:[e.jsxs("div",{className:s.syllabusHeader,children:[e.jsx("strong",{children:u.title}),e.jsx("span",{className:s.syllabusLevel,children:u.level})]}),u.description&&e.jsx("p",{className:s.syllabusDescription,children:u.description}),u.objectives&&u.objectives.length>0&&e.jsxs("div",{className:s.syllabusObjectives,children:[e.jsx("strong",{children:"Learning Objectives:"}),e.jsx("ul",{children:u.objectives.map((r,n)=>e.jsx("li",{children:r},n))})]}),e.jsxs("div",{className:s.syllabusModules,children:[e.jsxs("strong",{children:["Modules (",u.modules.length,"):"]}),e.jsx("ol",{children:u.modules.map((r,n)=>e.jsxs("li",{children:[e.jsx("strong",{children:r.title}),r.description&&e.jsx("p",{className:s.moduleDescription,children:r.description})]},n))})]}),u.external_sources&&u.external_sources.length>0&&e.jsxs("div",{className:s.syllabusSources,children:[e.jsx("strong",{children:"Sources:"}),e.jsx("ul",{children:u.external_sources.map((r,n)=>e.jsx("li",{children:e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",children:r.title||r.url})},n))})]})]})]})]})]}),e.jsxs("section",{className:s.section,children:[e.jsx("h2",{children:"Course Settings"}),e.jsxs("div",{className:s.formRow,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"difficulty_level",children:"Difficulty Level"}),e.jsx("select",{id:"difficulty_level",name:"difficulty_level",value:o.difficulty_level,onChange:f,children:O.map(r=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"estimated_duration",children:"Estimated Duration"}),e.jsx("input",{type:"number",id:"estimated_duration",name:"estimated_duration",value:o.estimated_duration||"",onChange:f,min:"1",placeholder:"e.g., 8"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"duration_unit",children:"Duration Unit"}),e.jsx("select",{id:"duration_unit",name:"duration_unit",value:o.duration_unit,onChange:f,children:M.map(r=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"price",children:"Price (USD)"}),e.jsx("input",{type:"number",id:"price",name:"price",value:o.price,onChange:f,min:"0",step:"0.01",placeholder:"0.00"}),e.jsx("span",{className:s.helpText,children:"Set to 0 for free courses"})]})]}),e.jsxs("section",{className:s.section,children:[e.jsx("h2",{children:"Tags"}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"tag-input",children:"Add Tags"}),e.jsxs("div",{className:s.tagInputContainer,children:[e.jsx("input",{type:"text",id:"tag-input",value:N,onChange:r=>k(r.target.value),onKeyPress:r=>{r.key==="Enter"&&(r.preventDefault(),P())},placeholder:"Type a tag and press Enter"}),e.jsx("button",{type:"button",onClick:P,className:s.addTagBtn,children:"Add Tag"})]}),o.tags&&o.tags.length>0&&e.jsx("div",{className:s.tagsList,children:o.tags.map(r=>e.jsxs("span",{className:s.tag,children:[r,e.jsx("button",{type:"button",onClick:()=>W(r),className:s.removeTagBtn,"aria-label":`Remove ${r}`,children:"×"})]},r))})]})]}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{type:"button",onClick:()=>j(-1),className:s.cancelBtn,disabled:w,children:"Cancel"}),e.jsx("button",{type:"submit",className:s.submitBtn,disabled:w,children:w?"Creating...":"Create Course"})]})]})]})};export{as as CourseCreatePage};
//# sourceMappingURL=CourseCreatePage-DPPg86hz.js.map
