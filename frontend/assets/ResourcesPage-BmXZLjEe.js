import{u as D,j as e}from"./query-vendor-DXemzGoE.js";import{f as T,a as c,L as W}from"./react-vendor-DLPaXABT.js";import{D as h}from"./DashboardLayout-DOQfX6XB.js";import{S as w,C as l,B as o,H as p,c as S}from"./index-CUzrOw_I.js";import{I as A}from"./Input-I95rkvnn.js";import"./state-vendor-DnXO85Wm.js";const P=()=>{const[z]=T(),x=z.get("download")==="true",[r,y]=c.useState(""),[s,m]=c.useState("all"),[g,u]=c.useState(new Set),{data:C,isLoading:B,error:b}=D({queryKey:["studentResources"],queryFn:async()=>(await S.get("/api/v1/resources/my-resources")).data,staleTime:300*1e3,retry:2}),n=C?.resources||[],f=c.useMemo(()=>n.filter(t=>{const i=r===""||t.title.toLowerCase().includes(r.toLowerCase())||t.description.toLowerCase().includes(r.toLowerCase())||t.course_title.toLowerCase().includes(r.toLowerCase()),a=s==="all"||t.type===s;return i&&a}),[n,r,s]),j=t=>({video:"ðŸŽ¥",document:"ðŸ“„",code:"ðŸ’»",slides:"ðŸ“Š",dataset:"ðŸ“Š",other:"ðŸ“"})[t]||"ðŸ“",v=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:t<1024*1024*1024?`${(t/(1024*1024)).toFixed(1)} MB`:`${(t/(1024*1024*1024)).toFixed(1)} GB`,L=async t=>{u(i=>new Set([...i,t.id]));try{const i=await S.get(`/api/v1/resources/${t.id}/download`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([i.data])),d=document.createElement("a");d.href=a,d.download=`${t.title}.${t.format}`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(a)}catch(i){console.error("Download failed:",i),alert("Download failed. Please try again.")}finally{u(i=>{const a=new Set(i);return a.delete(t.id),a})}},R=c.useMemo(()=>{const t=new Set(n.map(i=>i.type));return Array.from(t)},[n]);return B?e.jsx(h,{children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsx(w,{size:"large"})})}):b?e.jsx(h,{children:e.jsx("main",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:e.jsxs(l,{variant:"outlined",padding:"large",style:{textAlign:"center"},children:[e.jsx("p",{style:{color:"#dc2626",marginBottom:"1rem"},children:"Unable to load resources. Please try refreshing the page."}),e.jsx(o,{variant:"primary",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})}):e.jsx(h,{children:e.jsxs("main",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx(p,{level:"h1",gutterBottom:!0,children:x?"Download Materials":"Learning Resources"}),e.jsx("p",{style:{color:"#666",fontSize:"0.95rem"},children:x?"Download course materials for offline access":"Access course materials, videos, and documentation"})]}),e.jsx(l,{variant:"outlined",padding:"medium",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("div",{style:{flex:1,minWidth:"250px"},children:e.jsx(A,{type:"search",placeholder:"Search resources...",value:r,onChange:t=>y(t.target.value)})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx(o,{variant:s==="all"?"primary":"secondary",size:"small",onClick:()=>m("all"),children:"All"}),R.map(t=>e.jsxs(o,{variant:s===t?"primary":"secondary",size:"small",onClick:()=>m(t),children:[j(t)," ",t.charAt(0).toUpperCase()+t.slice(1)]},t))]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[e.jsx(l,{variant:"elevated",padding:"medium",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6"},children:n.length}),e.jsx("div",{style:{color:"#666",fontSize:"0.875rem"},children:"Total Resources"})]})}),e.jsx(l,{variant:"elevated",padding:"medium",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#10b981"},children:n.filter(t=>t.type==="video").length}),e.jsx("div",{style:{color:"#666",fontSize:"0.875rem"},children:"Videos"})]})}),e.jsx(l,{variant:"elevated",padding:"medium",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#8b5cf6"},children:n.filter(t=>t.type==="document").length}),e.jsx("div",{style:{color:"#666",fontSize:"0.875rem"},children:"Documents"})]})}),e.jsx(l,{variant:"elevated",padding:"medium",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#f59e0b"},children:v(n.reduce((t,i)=>t+i.file_size_bytes,0))}),e.jsx("div",{style:{color:"#666",fontSize:"0.875rem"},children:"Total Size"})]})})]}),f.length>0?e.jsx("div",{style:{display:"grid",gap:"1rem"},children:f.map(t=>e.jsx(l,{variant:"outlined",padding:"large",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",flex:1,minWidth:"200px"},children:[e.jsx("div",{style:{fontSize:"2.5rem"},children:j(t.type)}),e.jsxs("div",{children:[e.jsx(p,{level:"h3",style:{fontSize:"1.1rem",marginBottom:"0.25rem"},children:t.title}),e.jsx("p",{style:{color:"#666",fontSize:"0.875rem",marginBottom:"0.5rem"},children:t.description}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem",fontSize:"0.75rem",color:"#666"},children:[e.jsxs("span",{children:["ðŸ“š ",t.course_title]}),e.jsxs("span",{children:["ðŸ“ ",t.format.toUpperCase()]}),e.jsxs("span",{children:["ðŸ’¾ ",v(t.file_size_bytes)]}),e.jsxs("span",{children:["ðŸ“… ",new Date(t.created_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.type==="video"?e.jsx(W,{to:`/courses/${t.course_id}/videos/${t.id}`,children:e.jsx(o,{variant:"primary",size:"medium",children:"â–¶ï¸ Watch"})}):null,e.jsx(o,{variant:"secondary",size:"medium",onClick:()=>L(t),disabled:g.has(t.id),"data-action":"download",children:g.has(t.id)?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:"small"})," Downloading..."]}):"â¬‡ï¸ Download"})]})]})},t.id))}):e.jsxs(l,{variant:"outlined",padding:"large",style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"ðŸ“š"}),e.jsx(p,{level:"h3",style:{marginBottom:"0.5rem"},children:r||s!=="all"?"No Resources Found":"No Resources Available"}),e.jsx("p",{style:{color:"#666",marginBottom:"1.5rem"},children:r||s!=="all"?"Try adjusting your search or filters.":"Resources will appear here once your trainer adds them to your enrolled courses."}),(r||s!=="all")&&e.jsx(o,{variant:"primary",onClick:()=>{y(""),m("all")},children:"Clear Filters"})]})]})})};export{P as ResourcesPage};
//# sourceMappingURL=ResourcesPage-BmXZLjEe.js.map
