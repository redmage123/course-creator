{"version":3,"file":"CourseCreatePage-D6bqyxom.js","sources":["../../src/services/courseService.ts","../../src/services/syllabusService.ts","../../src/features/courses/pages/CourseCreatePage.tsx"],"sourcesContent":["/**\n * Course Management Service\n *\n * BUSINESS CONTEXT:\n * Manages course creation, updates, and lifecycle within the educational platform.\n * Supports both standalone course creation (individual instructors) and organizational\n * course creation (corporate training programs with track/project hierarchy).\n *\n * TECHNICAL IMPLEMENTATION:\n * - RESTful API calls to course-management service\n * - Type-safe TypeScript interfaces\n * - Error handling and validation\n * - Support for filtering and search\n */\n\nimport { apiClient } from './apiClient';\n\n/**\n * Difficulty levels for courses\n */\nexport type DifficultyLevel = 'beginner' | 'intermediate' | 'advanced';\n\n/**\n * Duration units for course timing\n */\nexport type DurationUnit = 'hours' | 'days' | 'weeks' | 'months';\n\n/**\n * Course entity\n */\nexport interface Course {\n  id: string;\n  title: string;\n  description: string;\n  instructor_id: string;\n  category?: string;\n  difficulty_level: DifficultyLevel;\n  estimated_duration?: number;\n  duration_unit: DurationUnit;\n  price: number;\n  tags: string[];\n  is_published: boolean;\n  organization_id?: string;\n  track_id?: string;\n  location_id?: string;\n  created_at: string;\n  updated_at: string;\n}\n\n/**\n * Create course request\n *\n * SUPPORTS TWO MODES:\n * - Standalone: organization_id, track_id, location_id are null\n * - Organizational: Can provide organization_id, track_id, location_id for hierarchy\n */\nexport interface CreateCourseRequest {\n  title: string;\n  description: string;\n  category?: string;\n  difficulty_level?: DifficultyLevel;\n  estimated_duration?: number;\n  duration_unit?: DurationUnit;\n  price?: number;\n  tags?: string[];\n  // Organizational context (optional)\n  organization_id?: string;\n  track_id?: string;\n  location_id?: string;\n}\n\n/**\n * Update course request\n */\nexport interface UpdateCourseRequest {\n  title?: string;\n  description?: string;\n  category?: string;\n  difficulty_level?: DifficultyLevel;\n  estimated_duration?: number;\n  duration_unit?: DurationUnit;\n  price?: number;\n  tags?: string[];\n}\n\n/**\n * Course list response\n */\nexport interface CourseListResponse {\n  courses: Course[];\n  total: number;\n  page?: number;\n  limit?: number;\n}\n\n/**\n * Course filters\n */\nexport interface CourseFilters {\n  organization_id?: string;\n  track_id?: string;\n  instructor_id?: string;\n  difficulty_level?: DifficultyLevel;\n  category?: string;\n  published_only?: boolean;\n}\n\n/**\n * Course Service\n *\n * WHY THIS APPROACH:\n * - Centralized course management logic\n * - Type-safe API interactions\n * - Consistent error handling\n * - Easy to test and mock\n */\nclass CourseService {\n  /**\n   * Get all courses with optional filters\n   *\n   * @param filters - Optional filters for courses\n   * @returns List of courses\n   */\n  async getCourses(filters?: CourseFilters): Promise<Course[]> {\n    const params = new URLSearchParams();\n\n    if (filters) {\n      if (filters.organization_id) params.append('organization_id', filters.organization_id);\n      if (filters.track_id) params.append('track_id', filters.track_id);\n      if (filters.instructor_id) params.append('instructor_id', filters.instructor_id);\n      if (filters.difficulty_level) params.append('difficulty_level', filters.difficulty_level);\n      if (filters.category) params.append('category', filters.category);\n      if (filters.published_only !== undefined) params.append('published_only', String(filters.published_only));\n    }\n\n    const queryString = params.toString();\n    const url = `/courses${queryString ? `?${queryString}` : ''}`;\n\n    const response = await apiClient.get<Course[]>(url);\n    return response;\n  }\n\n  /**\n   * Get course by ID\n   *\n   * @param courseId - Course ID\n   * @returns Course details\n   */\n  async getCourseById(courseId: string): Promise<Course> {\n    const response = await apiClient.get<Course>(`/courses/${courseId}`);\n    return response;\n  }\n\n  /**\n   * Create new course\n   *\n   * BUSINESS CONTEXT:\n   * Creates a new course in the platform. Supports both standalone course creation\n   * (for individual instructors) and organizational course creation (for corporate\n   * training programs with organizational hierarchy).\n   *\n   * TECHNICAL IMPLEMENTATION:\n   * - Calls POST /courses endpoint\n   * - Instructor ID is automatically assigned from authentication token\n   * - Course starts in unpublished/draft state\n   * - Returns created course with generated ID\n   *\n   * @param courseData - Course creation data\n   * @returns Created course\n   */\n  async createCourse(courseData: CreateCourseRequest): Promise<Course> {\n    const response = await apiClient.post<Course>('/courses', courseData);\n    return response;\n  }\n\n  /**\n   * Update course\n   *\n   * @param courseId - Course ID\n   * @param updates - Course updates\n   * @returns Updated course\n   */\n  async updateCourse(courseId: string, updates: UpdateCourseRequest): Promise<Course> {\n    const response = await apiClient.put<Course>(`/courses/${courseId}`, updates);\n    return response;\n  }\n\n  /**\n   * Delete course\n   *\n   * @param courseId - Course ID\n   */\n  async deleteCourse(courseId: string): Promise<void> {\n    await apiClient.delete(`/courses/${courseId}`);\n  }\n\n  /**\n   * Publish course\n   *\n   * @param courseId - Course ID\n   * @returns Published course\n   */\n  async publishCourse(courseId: string): Promise<Course> {\n    const response = await apiClient.post<Course>(`/courses/${courseId}/publish`, {});\n    return response;\n  }\n\n  /**\n   * Unpublish course\n   *\n   * @param courseId - Course ID\n   * @returns Unpublished course\n   */\n  async unpublishCourse(courseId: string): Promise<Course> {\n    const response = await apiClient.post<Course>(`/courses/${courseId}/unpublish`, {});\n    return response;\n  }\n\n  /**\n   * Get courses by track\n   *\n   * @param trackId - Track ID\n   * @returns List of courses in the track\n   */\n  async getCoursesByTrack(trackId: string): Promise<Course[]> {\n    return this.getCourses({ track_id: trackId });\n  }\n\n  /**\n   * Get courses by organization\n   *\n   * @param organizationId - Organization ID\n   * @param publishedOnly - Filter for published courses only\n   * @returns List of courses in the organization\n   */\n  async getCoursesByOrganization(\n    organizationId: string,\n    publishedOnly: boolean = false\n  ): Promise<Course[]> {\n    return this.getCourses({ organization_id: organizationId, published_only: publishedOnly });\n  }\n}\n\n// Export singleton instance\nexport const courseService = new CourseService();\n","/**\n * Syllabus Generation Service\n *\n * BUSINESS CONTEXT:\n * Enables URL-based course generation from external third-party documentation.\n * Instructors can provide documentation URLs (Salesforce, AWS, internal wikis, etc.)\n * and the system will automatically generate comprehensive training materials.\n *\n * TECHNICAL IMPLEMENTATION:\n * - Calls course-generator API for URL-based generation\n * - Supports progress tracking for long-running operations\n * - Type-safe TypeScript interfaces\n * - Error handling for various failure scenarios\n *\n * @version 3.3.2\n */\n\nimport { apiClient } from './apiClient';\n\n/**\n * Course difficulty levels\n */\nexport type CourseLevel = 'beginner' | 'intermediate' | 'advanced';\n\n/**\n * Content source types for external documentation\n */\nexport type ContentSourceType =\n  | 'documentation'\n  | 'tutorial'\n  | 'api_reference'\n  | 'knowledge_base'\n  | 'blog'\n  | 'wiki'\n  | 'general';\n\n/**\n * External source configuration\n *\n * Allows advanced configuration for documentation sources\n * including type classification and priority for multi-URL requests.\n */\nexport interface ExternalSourceConfig {\n  url: string;\n  source_type?: ContentSourceType;\n  priority?: number; // 1-10, higher = more important\n  description?: string;\n}\n\n/**\n * Module topic within a syllabus module\n */\nexport interface ModuleTopic {\n  title: string;\n  description: string;\n  duration?: number; // minutes\n  objectives?: string[];\n}\n\n/**\n * Syllabus module\n */\nexport interface SyllabusModule {\n  module_number: number;\n  title: string;\n  description: string;\n  duration?: number; // minutes\n  objectives?: string[];\n  topics?: ModuleTopic[];\n  source_url?: string; // Attribution to source URL\n}\n\n/**\n * Generated syllabus data\n */\nexport interface SyllabusData {\n  title: string;\n  description: string;\n  level: CourseLevel;\n  duration?: number; // hours\n  objectives?: string[];\n  prerequisites?: string[];\n  target_audience?: string;\n  modules: SyllabusModule[];\n  external_sources?: Array<{\n    url: string;\n    title?: string;\n  }>;\n  generated_at?: string;\n  generation_method?: string;\n}\n\n/**\n * Request for syllabus generation\n *\n * SUPPORTS TWO MODES:\n * - Standard: Generate from title/description only\n * - URL-based: Generate from external documentation URLs\n */\nexport interface GenerateSyllabusRequest {\n  title: string;\n  description: string;\n  level?: CourseLevel;\n  duration?: number; // hours\n  objectives?: string[];\n  prerequisites?: string[];\n  target_audience?: string;\n\n  // URL-based generation fields (v3.3.2)\n  source_url?: string;\n  source_urls?: string[];\n  external_sources?: ExternalSourceConfig[];\n\n  // URL processing options\n  use_rag_enhancement?: boolean;\n  include_code_examples?: boolean;\n  max_content_chunks?: number;\n}\n\n/**\n * Source summary from URL-based generation\n */\nexport interface SourceSummary {\n  urls_processed: number;\n  urls_failed: number;\n  total_words?: number;\n  total_chunks?: number;\n  code_examples_found?: number;\n  sources?: Array<{\n    url: string;\n    title?: string;\n    word_count?: number;\n  }>;\n}\n\n/**\n * Response from syllabus generation\n */\nexport interface GenerateSyllabusResponse {\n  success: boolean;\n  syllabus?: SyllabusData;\n  message?: string;\n  course_id?: string;\n  generation_method?: string;\n  source_summary?: SourceSummary;\n  processing_time_ms?: number;\n  request_id?: string;\n}\n\n/**\n * Generation progress information\n */\nexport interface GenerationProgress {\n  request_id: string;\n  status: string;\n  total_urls: number;\n  urls_fetched: number;\n  urls_failed: number;\n  chunks_created: number;\n  chunks_ingested: number;\n  generation_started: boolean;\n  generation_complete: boolean;\n  current_step: string;\n  error_count: number;\n  elapsed_seconds: number;\n}\n\n/**\n * Progress response\n */\nexport interface GetProgressResponse {\n  success: boolean;\n  progress: GenerationProgress;\n}\n\n/**\n * Validation error details\n */\nexport interface ValidationErrorDetail {\n  loc: (string | number)[];\n  msg: string;\n  type: string;\n}\n\n/**\n * API error response\n */\nexport interface APIErrorResponse {\n  detail?: string | { error: string; message: string; error_code?: string } | ValidationErrorDetail[];\n}\n\n/**\n * Syllabus Generation Service\n *\n * WHY THIS APPROACH:\n * - Dedicated service for syllabus generation operations\n * - Separate from course management CRUD operations\n * - Supports long-running operations with progress tracking\n * - Clear error handling for URL-related failures\n */\nclass SyllabusService {\n  private baseUrl = '/api/v1/syllabus';\n\n  /**\n   * Generate syllabus from provided parameters\n   *\n   * SUPPORTS TWO GENERATION MODES:\n   * 1. Standard: Uses title/description only\n   * 2. URL-based: Fetches content from external URLs\n   *\n   * @param request - Generation request with optional URLs\n   * @returns Generated syllabus with source attribution\n   */\n  async generateSyllabus(request: GenerateSyllabusRequest): Promise<GenerateSyllabusResponse> {\n    try {\n      const response = await apiClient.post<GenerateSyllabusResponse>(\n        `${this.baseUrl}/generate`,\n        request\n      );\n      return response;\n    } catch (error) {\n      // Transform error for better UI handling\n      throw this.transformError(error);\n    }\n  }\n\n  /**\n   * Get progress of a generation request\n   *\n   * BUSINESS CONTEXT:\n   * URL-based generation can take time due to fetching multiple URLs.\n   * This allows the UI to show real-time progress updates.\n   *\n   * @param requestId - UUID of the generation request\n   * @returns Progress information\n   */\n  async getGenerationProgress(requestId: string): Promise<GetProgressResponse> {\n    try {\n      const response = await apiClient.get<GetProgressResponse>(\n        `${this.baseUrl}/generate/progress/${requestId}`\n      );\n      return response;\n    } catch (error) {\n      throw this.transformError(error);\n    }\n  }\n\n  /**\n   * Validate URL format\n   *\n   * @param url - URL to validate\n   * @returns Whether URL is valid\n   */\n  validateUrl(url: string): { valid: boolean; error?: string } {\n    if (!url || !url.trim()) {\n      return { valid: false, error: 'URL cannot be empty' };\n    }\n\n    const trimmedUrl = url.trim();\n\n    // Check scheme\n    if (!trimmedUrl.startsWith('http://') && !trimmedUrl.startsWith('https://')) {\n      return { valid: false, error: 'URL must start with http:// or https://' };\n    }\n\n    // Check length\n    if (trimmedUrl.length > 2048) {\n      return { valid: false, error: 'URL exceeds maximum length of 2048 characters' };\n    }\n\n    // Basic URL format check\n    try {\n      new URL(trimmedUrl);\n    } catch {\n      return { valid: false, error: 'Invalid URL format' };\n    }\n\n    return { valid: true };\n  }\n\n  /**\n   * Validate multiple URLs\n   *\n   * @param urls - Array of URLs to validate\n   * @returns Validation results\n   */\n  validateUrls(urls: string[]): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    // Check count limit\n    if (urls.length > 10) {\n      errors.push('Maximum 10 URLs allowed');\n    }\n\n    // Validate each URL\n    urls.forEach((url, index) => {\n      const result = this.validateUrl(url);\n      if (!result.valid) {\n        errors.push(`URL ${index + 1}: ${result.error}`);\n      }\n    });\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * Transform API errors for UI display\n   *\n   * @param error - Raw error from API\n   * @returns Transformed error with user-friendly message\n   */\n  private transformError(error: unknown): Error {\n    if (error instanceof Error) {\n      // Check if it's an API error with details\n      const apiError = error as Error & { response?: { data?: APIErrorResponse } };\n\n      if (apiError.response?.data?.detail) {\n        const detail = apiError.response.data.detail;\n\n        if (typeof detail === 'string') {\n          return new Error(detail);\n        }\n\n        if (Array.isArray(detail)) {\n          // Validation errors\n          const messages = detail.map(\n            (d: ValidationErrorDetail) => `${d.loc.join('.')}: ${d.msg}`\n          );\n          return new Error(`Validation failed: ${messages.join(', ')}`);\n        }\n\n        if (typeof detail === 'object' && 'message' in detail) {\n          return new Error(detail.message);\n        }\n      }\n\n      return error;\n    }\n\n    return new Error('An unexpected error occurred');\n  }\n\n  /**\n   * Check if generation request has external sources\n   *\n   * @param request - Generation request\n   * @returns Whether request includes external URLs\n   */\n  hasExternalSources(request: GenerateSyllabusRequest): boolean {\n    return Boolean(\n      request.source_url ||\n        (request.source_urls && request.source_urls.length > 0) ||\n        (request.external_sources && request.external_sources.length > 0)\n    );\n  }\n\n  /**\n   * Get all source URLs from request\n   *\n   * @param request - Generation request\n   * @returns Array of all source URLs\n   */\n  getAllSourceUrls(request: GenerateSyllabusRequest): string[] {\n    const urls: string[] = [];\n\n    if (request.source_url) {\n      urls.push(request.source_url);\n    }\n\n    if (request.source_urls) {\n      urls.push(...request.source_urls);\n    }\n\n    if (request.external_sources) {\n      request.external_sources.forEach((source) => {\n        if (!urls.includes(source.url)) {\n          urls.push(source.url);\n        }\n      });\n    }\n\n    return urls;\n  }\n}\n\n// Export singleton instance\nexport const syllabusService = new SyllabusService();\n","/**\n * Course Create Page\n *\n * BUSINESS CONTEXT:\n * Allows instructors to create new courses. Supports both standalone course creation\n * (individual instructors) and organizational course creation (corporate training with\n * track/project hierarchy).\n *\n * URL-BASED GENERATION (v3.3.2):\n * Instructors can now provide external documentation URLs (Salesforce, AWS, internal wikis)\n * to automatically generate course syllabi and content. The system fetches, parses, and\n * uses RAG to create comprehensive training materials from third-party documentation.\n *\n * TECHNICAL IMPLEMENTATION:\n * - Form validation with real-time feedback\n * - Integration with course-management API\n * - URL-based generation with progress tracking\n * - Automatic redirect after creation\n * - Support for organizational context (track_id) from URL params\n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport {\n  courseService,\n  syllabusService,\n  type CreateCourseRequest,\n  type DifficultyLevel,\n  type DurationUnit,\n  type GenerateSyllabusRequest,\n  type SyllabusData,\n  type GenerationProgress,\n  type CourseLevel,\n} from '../../../services';\nimport { useAuth } from '../../../hooks/useAuth';\nimport styles from './CourseCreatePage.module.css';\n\nexport const CourseCreatePage: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const { user } = useAuth();\n\n  // Get track_id from URL params if provided (for organizational course creation)\n  const trackIdFromUrl = searchParams.get('track_id');\n  const organizationId = user?.organization_id;\n\n  const [formData, setFormData] = useState<CreateCourseRequest>({\n    title: '',\n    description: '',\n    category: '',\n    difficulty_level: 'beginner',\n    estimated_duration: undefined,\n    duration_unit: 'weeks',\n    price: 0,\n    tags: [],\n    organization_id: organizationId,\n    track_id: trackIdFromUrl || undefined,\n  });\n\n  const [tagInput, setTagInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // URL-based generation state\n  const [useUrlGeneration, setUseUrlGeneration] = useState(false);\n  const [sourceUrls, setSourceUrls] = useState<string[]>(['']);\n  const [urlErrors, setUrlErrors] = useState<string[]>([]);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [generationProgress, setGenerationProgress] = useState<GenerationProgress | null>(null);\n  const [generatedSyllabus, setGeneratedSyllabus] = useState<SyllabusData | null>(null);\n  const [useRagEnhancement, setUseRagEnhancement] = useState(true);\n  const [includeCodeExamples, setIncludeCodeExamples] = useState(true);\n  const progressIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  const difficultyOptions: DifficultyLevel[] = ['beginner', 'intermediate', 'advanced'];\n  const courseLevelOptions: CourseLevel[] = ['beginner', 'intermediate', 'advanced'];\n  const durationUnits: DurationUnit[] = ['hours', 'days', 'weeks', 'months'];\n\n  const handleInputChange = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>\n  ) => {\n    const { name, value } = e.target;\n\n    setFormData((prev) => ({\n      ...prev,\n      [name]: name === 'estimated_duration' || name === 'price'\n        ? value ? parseFloat(value) : undefined\n        : value,\n    }));\n  };\n\n  const handleAddTag = () => {\n    if (tagInput.trim() && !formData.tags?.includes(tagInput.trim())) {\n      setFormData((prev) => ({\n        ...prev,\n        tags: [...(prev.tags || []), tagInput.trim()],\n      }));\n      setTagInput('');\n    }\n  };\n\n  const handleRemoveTag = (tagToRemove: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      tags: prev.tags?.filter((tag) => tag !== tagToRemove) || [],\n    }));\n  };\n\n  // URL-based generation handlers\n  const handleUrlChange = (index: number, value: string) => {\n    const newUrls = [...sourceUrls];\n    newUrls[index] = value;\n    setSourceUrls(newUrls);\n\n    // Validate as user types\n    const newErrors = [...urlErrors];\n    if (value.trim()) {\n      const validation = syllabusService.validateUrl(value);\n      newErrors[index] = validation.error || '';\n    } else {\n      newErrors[index] = '';\n    }\n    setUrlErrors(newErrors);\n  };\n\n  const handleAddUrl = () => {\n    if (sourceUrls.length < 10) {\n      setSourceUrls([...sourceUrls, '']);\n      setUrlErrors([...urlErrors, '']);\n    }\n  };\n\n  const handleRemoveUrl = (index: number) => {\n    if (sourceUrls.length > 1) {\n      const newUrls = sourceUrls.filter((_, i) => i !== index);\n      const newErrors = urlErrors.filter((_, i) => i !== index);\n      setSourceUrls(newUrls);\n      setUrlErrors(newErrors);\n    }\n  };\n\n  const getValidUrls = useCallback(() => {\n    return sourceUrls.filter((url) => {\n      const trimmed = url.trim();\n      return trimmed && syllabusService.validateUrl(trimmed).valid;\n    });\n  }, [sourceUrls]);\n\n  // Cleanup progress polling on unmount\n  useEffect(() => {\n    return () => {\n      if (progressIntervalRef.current) {\n        clearInterval(progressIntervalRef.current);\n      }\n    };\n  }, []);\n\n  const startProgressPolling = useCallback((requestId: string) => {\n    if (progressIntervalRef.current) {\n      clearInterval(progressIntervalRef.current);\n    }\n\n    progressIntervalRef.current = setInterval(async () => {\n      try {\n        const response = await syllabusService.getGenerationProgress(requestId);\n        if (response.success) {\n          setGenerationProgress(response.progress);\n\n          // Stop polling when complete\n          if (response.progress.generation_complete) {\n            if (progressIntervalRef.current) {\n              clearInterval(progressIntervalRef.current);\n              progressIntervalRef.current = null;\n            }\n          }\n        }\n      } catch (err) {\n        console.error('Progress polling error:', err);\n      }\n    }, 2000);\n  }, []);\n\n  const handleGenerateSyllabus = async () => {\n    const validUrls = getValidUrls();\n    if (validUrls.length === 0) {\n      setError('Please enter at least one valid URL');\n      return;\n    }\n\n    if (!formData.title.trim()) {\n      setError('Please enter a course title before generating');\n      return;\n    }\n\n    setIsGenerating(true);\n    setError(null);\n    setGeneratedSyllabus(null);\n    setGenerationProgress(null);\n\n    try {\n      const request: GenerateSyllabusRequest = {\n        title: formData.title,\n        description: formData.description || `Training course generated from external documentation`,\n        level: formData.difficulty_level as CourseLevel,\n        source_urls: validUrls,\n        use_rag_enhancement: useRagEnhancement,\n        include_code_examples: includeCodeExamples,\n      };\n\n      const response = await syllabusService.generateSyllabus(request);\n\n      if (response.request_id) {\n        startProgressPolling(response.request_id);\n      }\n\n      if (response.success && response.syllabus) {\n        setGeneratedSyllabus(response.syllabus);\n\n        // Auto-fill form with generated content\n        if (response.syllabus.description && !formData.description) {\n          setFormData((prev) => ({\n            ...prev,\n            description: response.syllabus!.description,\n          }));\n        }\n      } else {\n        setError(response.message || 'Failed to generate syllabus');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Generation failed');\n      console.error('Syllabus generation error:', err);\n    } finally {\n      setIsGenerating(false);\n      if (progressIntervalRef.current) {\n        clearInterval(progressIntervalRef.current);\n        progressIntervalRef.current = null;\n      }\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Validate required fields\n      if (!formData.title.trim()) {\n        throw new Error('Course title is required');\n      }\n      if (!formData.description.trim()) {\n        throw new Error('Course description is required');\n      }\n\n      await courseService.createCourse(formData);\n\n      // Redirect based on context\n      if (trackIdFromUrl) {\n        // If created from a track, redirect back to tracks page\n        navigate('/organization/tracks');\n      } else {\n        // Otherwise redirect to courses list (when implemented)\n        navigate('/dashboard/org-admin');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create course');\n      console.error('Course creation error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <h1>Create New Course</h1>\n        <p className={styles.subtitle}>\n          {trackIdFromUrl\n            ? 'Add a new course to your learning track'\n            : 'Create a standalone course'}\n        </p>\n      </div>\n\n      <form className={styles.form} onSubmit={handleSubmit}>\n        {error && (\n          <div className={styles.error} role=\"alert\">\n            {error}\n          </div>\n        )}\n\n        {/* Basic Information */}\n        <section className={styles.section}>\n          <h2>Basic Information</h2>\n\n          <div className={styles.formGroup}>\n            <label htmlFor=\"title\">\n              Course Title <span className={styles.required}>*</span>\n            </label>\n            <input\n              type=\"text\"\n              id=\"title\"\n              name=\"title\"\n              value={formData.title}\n              onChange={handleInputChange}\n              placeholder=\"e.g., Introduction to Python Programming\"\n              required\n              maxLength={200}\n            />\n          </div>\n\n          <div className={styles.formGroup}>\n            <label htmlFor=\"description\">\n              Description <span className={styles.required}>*</span>\n            </label>\n            <textarea\n              id=\"description\"\n              name=\"description\"\n              value={formData.description}\n              onChange={handleInputChange}\n              placeholder=\"Provide a detailed description of the course...\"\n              required\n              maxLength={2000}\n              rows={5}\n            />\n            <span className={styles.charCount}>\n              {formData.description.length} / 2000\n            </span>\n          </div>\n\n          <div className={styles.formGroup}>\n            <label htmlFor=\"category\">Category</label>\n            <input\n              type=\"text\"\n              id=\"category\"\n              name=\"category\"\n              value={formData.category || ''}\n              onChange={handleInputChange}\n              placeholder=\"e.g., Programming, Data Science, Business\"\n            />\n          </div>\n        </section>\n\n        {/* URL-Based Generation Section */}\n        <section className={styles.section}>\n          <div className={styles.sectionHeader}>\n            <h2>AI-Powered Content Generation</h2>\n            <label className={styles.toggleLabel}>\n              <input\n                type=\"checkbox\"\n                checked={useUrlGeneration}\n                onChange={(e) => setUseUrlGeneration(e.target.checked)}\n                className={styles.toggleCheckbox}\n              />\n              <span className={styles.toggleSwitch} />\n              Generate from external documentation\n            </label>\n          </div>\n\n          {useUrlGeneration && (\n            <div className={styles.urlGenerationContent}>\n              <p className={styles.featureDescription}>\n                Automatically generate course content by providing URLs to external documentation.\n                Works with Salesforce docs, AWS documentation, internal wikis, and more.\n              </p>\n\n              {/* URL Input Fields */}\n              <div className={styles.formGroup}>\n                <label>Documentation URLs</label>\n                <div className={styles.urlInputList}>\n                  {sourceUrls.map((url, index) => (\n                    <div key={index} className={styles.urlInputRow}>\n                      <input\n                        type=\"url\"\n                        value={url}\n                        onChange={(e) => handleUrlChange(index, e.target.value)}\n                        placeholder=\"https://docs.example.com/guide\"\n                        className={urlErrors[index] ? styles.inputError : ''}\n                        disabled={isGenerating}\n                      />\n                      {sourceUrls.length > 1 && (\n                        <button\n                          type=\"button\"\n                          onClick={() => handleRemoveUrl(index)}\n                          className={styles.removeUrlBtn}\n                          disabled={isGenerating}\n                          aria-label=\"Remove URL\"\n                        >\n                          ×\n                        </button>\n                      )}\n                      {urlErrors[index] && (\n                        <span className={styles.urlError}>{urlErrors[index]}</span>\n                      )}\n                    </div>\n                  ))}\n                </div>\n                {sourceUrls.length < 10 && (\n                  <button\n                    type=\"button\"\n                    onClick={handleAddUrl}\n                    className={styles.addUrlBtn}\n                    disabled={isGenerating}\n                  >\n                    + Add another URL\n                  </button>\n                )}\n                <span className={styles.helpText}>\n                  Add up to 10 URLs. Supports HTTP/HTTPS documentation pages.\n                </span>\n              </div>\n\n              {/* Generation Options */}\n              <div className={styles.generationOptions}>\n                <label className={styles.checkboxLabel}>\n                  <input\n                    type=\"checkbox\"\n                    checked={useRagEnhancement}\n                    onChange={(e) => setUseRagEnhancement(e.target.checked)}\n                    disabled={isGenerating}\n                  />\n                  Use RAG enhancement for better context\n                </label>\n                <label className={styles.checkboxLabel}>\n                  <input\n                    type=\"checkbox\"\n                    checked={includeCodeExamples}\n                    onChange={(e) => setIncludeCodeExamples(e.target.checked)}\n                    disabled={isGenerating}\n                  />\n                  Include code examples from documentation\n                </label>\n              </div>\n\n              {/* Generate Button */}\n              <button\n                type=\"button\"\n                onClick={handleGenerateSyllabus}\n                className={styles.generateBtn}\n                disabled={isGenerating || getValidUrls().length === 0 || !formData.title.trim()}\n              >\n                {isGenerating ? 'Generating...' : 'Generate Syllabus from URLs'}\n              </button>\n\n              {/* Generation Progress */}\n              {isGenerating && generationProgress && (\n                <div className={styles.progressContainer}>\n                  <div className={styles.progressHeader}>\n                    <span className={styles.progressStep}>{generationProgress.current_step}</span>\n                    <span className={styles.progressTime}>\n                      {Math.round(generationProgress.elapsed_seconds)}s\n                    </span>\n                  </div>\n                  <div className={styles.progressBar}>\n                    <div\n                      className={styles.progressFill}\n                      style={{\n                        width: `${Math.min(\n                          ((generationProgress.urls_fetched + generationProgress.chunks_ingested) /\n                            (generationProgress.total_urls * 2 + 10)) *\n                            100,\n                          95\n                        )}%`,\n                      }}\n                    />\n                  </div>\n                  <div className={styles.progressDetails}>\n                    <span>URLs: {generationProgress.urls_fetched}/{generationProgress.total_urls}</span>\n                    {generationProgress.urls_failed > 0 && (\n                      <span className={styles.progressWarning}>\n                        ({generationProgress.urls_failed} failed)\n                      </span>\n                    )}\n                    <span>Chunks: {generationProgress.chunks_ingested}</span>\n                  </div>\n                </div>\n              )}\n\n              {/* Generated Syllabus Preview */}\n              {generatedSyllabus && (\n                <div className={styles.syllabusPreview}>\n                  <h3>Generated Syllabus Preview</h3>\n                  <div className={styles.syllabusContent}>\n                    <div className={styles.syllabusHeader}>\n                      <strong>{generatedSyllabus.title}</strong>\n                      <span className={styles.syllabusLevel}>{generatedSyllabus.level}</span>\n                    </div>\n                    {generatedSyllabus.description && (\n                      <p className={styles.syllabusDescription}>{generatedSyllabus.description}</p>\n                    )}\n                    {generatedSyllabus.objectives && generatedSyllabus.objectives.length > 0 && (\n                      <div className={styles.syllabusObjectives}>\n                        <strong>Learning Objectives:</strong>\n                        <ul>\n                          {generatedSyllabus.objectives.map((obj, i) => (\n                            <li key={i}>{obj}</li>\n                          ))}\n                        </ul>\n                      </div>\n                    )}\n                    <div className={styles.syllabusModules}>\n                      <strong>Modules ({generatedSyllabus.modules.length}):</strong>\n                      <ol>\n                        {generatedSyllabus.modules.map((module, i) => (\n                          <li key={i}>\n                            <strong>{module.title}</strong>\n                            {module.description && (\n                              <p className={styles.moduleDescription}>{module.description}</p>\n                            )}\n                          </li>\n                        ))}\n                      </ol>\n                    </div>\n                    {generatedSyllabus.external_sources && generatedSyllabus.external_sources.length > 0 && (\n                      <div className={styles.syllabusSources}>\n                        <strong>Sources:</strong>\n                        <ul>\n                          {generatedSyllabus.external_sources.map((source, i) => (\n                            <li key={i}>\n                              <a href={source.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                                {source.title || source.url}\n                              </a>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </section>\n\n        {/* Course Settings */}\n        <section className={styles.section}>\n          <h2>Course Settings</h2>\n\n          <div className={styles.formRow}>\n            <div className={styles.formGroup}>\n              <label htmlFor=\"difficulty_level\">Difficulty Level</label>\n              <select\n                id=\"difficulty_level\"\n                name=\"difficulty_level\"\n                value={formData.difficulty_level}\n                onChange={handleInputChange}\n              >\n                {difficultyOptions.map((level) => (\n                  <option key={level} value={level}>\n                    {level.charAt(0).toUpperCase() + level.slice(1)}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className={styles.formGroup}>\n              <label htmlFor=\"estimated_duration\">Estimated Duration</label>\n              <input\n                type=\"number\"\n                id=\"estimated_duration\"\n                name=\"estimated_duration\"\n                value={formData.estimated_duration || ''}\n                onChange={handleInputChange}\n                min=\"1\"\n                placeholder=\"e.g., 8\"\n              />\n            </div>\n\n            <div className={styles.formGroup}>\n              <label htmlFor=\"duration_unit\">Duration Unit</label>\n              <select\n                id=\"duration_unit\"\n                name=\"duration_unit\"\n                value={formData.duration_unit}\n                onChange={handleInputChange}\n              >\n                {durationUnits.map((unit) => (\n                  <option key={unit} value={unit}>\n                    {unit.charAt(0).toUpperCase() + unit.slice(1)}\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div className={styles.formGroup}>\n            <label htmlFor=\"price\">Price (USD)</label>\n            <input\n              type=\"number\"\n              id=\"price\"\n              name=\"price\"\n              value={formData.price}\n              onChange={handleInputChange}\n              min=\"0\"\n              step=\"0.01\"\n              placeholder=\"0.00\"\n            />\n            <span className={styles.helpText}>Set to 0 for free courses</span>\n          </div>\n        </section>\n\n        {/* Tags */}\n        <section className={styles.section}>\n          <h2>Tags</h2>\n          <div className={styles.formGroup}>\n            <label htmlFor=\"tag-input\">Add Tags</label>\n            <div className={styles.tagInputContainer}>\n              <input\n                type=\"text\"\n                id=\"tag-input\"\n                value={tagInput}\n                onChange={(e) => setTagInput(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter') {\n                    e.preventDefault();\n                    handleAddTag();\n                  }\n                }}\n                placeholder=\"Type a tag and press Enter\"\n              />\n              <button\n                type=\"button\"\n                onClick={handleAddTag}\n                className={styles.addTagBtn}\n              >\n                Add Tag\n              </button>\n            </div>\n\n            {formData.tags && formData.tags.length > 0 && (\n              <div className={styles.tagsList}>\n                {formData.tags.map((tag) => (\n                  <span key={tag} className={styles.tag}>\n                    {tag}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveTag(tag)}\n                      className={styles.removeTagBtn}\n                      aria-label={`Remove ${tag}`}\n                    >\n                      ×\n                    </button>\n                  </span>\n                ))}\n              </div>\n            )}\n          </div>\n        </section>\n\n        {/* Form Actions */}\n        <div className={styles.actions}>\n          <button\n            type=\"button\"\n            onClick={() => navigate(-1)}\n            className={styles.cancelBtn}\n            disabled={loading}\n          >\n            Cancel\n          </button>\n          <button\n            type=\"submit\"\n            className={styles.submitBtn}\n            disabled={loading}\n          >\n            {loading ? 'Creating...' : 'Create Course'}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n"],"names":["CourseService","filters","params","queryString","url","apiClient","courseId","courseData","updates","trackId","organizationId","publishedOnly","courseService","SyllabusService","request","error","requestId","trimmedUrl","urls","errors","index","result","apiError","detail","messages","d","source","syllabusService","CourseCreatePage","navigate","useNavigate","searchParams","useSearchParams","user","useAuth","trackIdFromUrl","formData","setFormData","useState","tagInput","setTagInput","loading","setLoading","setError","useUrlGeneration","setUseUrlGeneration","sourceUrls","setSourceUrls","urlErrors","setUrlErrors","isGenerating","setIsGenerating","generationProgress","setGenerationProgress","generatedSyllabus","setGeneratedSyllabus","useRagEnhancement","setUseRagEnhancement","includeCodeExamples","setIncludeCodeExamples","progressIntervalRef","useRef","difficultyOptions","durationUnits","handleInputChange","e","name","value","prev","handleAddTag","handleRemoveTag","tagToRemove","tag","handleUrlChange","newUrls","newErrors","validation","handleAddUrl","handleRemoveUrl","_","i","getValidUrls","useCallback","trimmed","useEffect","startProgressPolling","response","err","handleGenerateSyllabus","validUrls","handleSubmit","jsxs","styles","jsx","obj","module","level","unit"],"mappings":"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"}