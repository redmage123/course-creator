{"version":3,"file":"ResetPassword-8EeQjcVh.js","sources":["../../src/features/auth/pages/ResetPasswordPage/ResetPasswordPage.tsx"],"sourcesContent":["/**\n * Reset Password Page Component\n *\n * BUSINESS CONTEXT:\n * Password reset confirmation page where users set a new password.\n * Uses token from email link to securely verify the reset request.\n *\n * TECHNICAL IMPLEMENTATION:\n * Form validation with controlled inputs, token extraction from URL,\n * password strength validation, and success confirmation.\n *\n * DESIGN PRINCIPLES:\n * - Clean, centered layout with Tami design system\n * - Strong password validation (8+ chars, mixed case, numbers)\n * - Clear success/error messages\n * - Accessible form with proper labels and ARIA attributes\n */\n\nimport React, { useState, FormEvent, useEffect } from 'react';\nimport { useNavigate, useSearchParams, Link } from 'react-router-dom';\nimport { Input } from '../../../../components/atoms/Input';\nimport { Button } from '../../../../components/atoms/Button';\nimport { Heading } from '../../../../components/atoms/Heading';\nimport { Card } from '../../../../components/atoms/Card';\nimport { authService } from '../../../../services/authService';\nimport styles from './ResetPasswordPage.module.css';\n\ninterface ResetPasswordFormData {\n  password: string;\n  confirmPassword: string;\n}\n\ninterface ResetPasswordFormErrors {\n  password?: string;\n  confirmPassword?: string;\n  submit?: string;\n}\n\n/**\n * Reset Password Page Component\n *\n * WHY THIS APPROACH:\n * - Extracts token from URL query params\n * - Controlled form inputs for validation\n * - Direct authService call (no auth state needed)\n * - Success state to show confirmation message\n * - Loading states to prevent double submission\n * - Clear error messages for user feedback\n *\n * @example\n * ```tsx\n * <Route path=\"/reset-password\" element={<ResetPasswordPage />} />\n * ```\n */\nexport const ResetPasswordPage: React.FC = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const token = searchParams.get('token');\n\n  const [formData, setFormData] = useState<ResetPasswordFormData>({\n    password: '',\n    confirmPassword: '',\n  });\n\n  const [errors, setErrors] = useState<ResetPasswordFormErrors>({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n\n  // Validate token exists\n  useEffect(() => {\n    if (!token) {\n      setErrors({\n        submit: 'Invalid or missing reset token. Please request a new password reset.',\n      });\n    }\n  }, [token]);\n\n  /**\n   * Validate form data\n   */\n  const validateForm = (): boolean => {\n    const newErrors: ResetPasswordFormErrors = {};\n\n    // Password validation\n    if (!formData.password) {\n      newErrors.password = 'Password is required';\n    } else if (formData.password.length < 8) {\n      newErrors.password = 'Password must be at least 8 characters';\n    } else if (!/(?=.*[a-z])/.test(formData.password)) {\n      newErrors.password = 'Password must contain at least one lowercase letter';\n    } else if (!/(?=.*[A-Z])/.test(formData.password)) {\n      newErrors.password = 'Password must contain at least one uppercase letter';\n    } else if (!/(?=.*\\d)/.test(formData.password)) {\n      newErrors.password = 'Password must contain at least one number';\n    }\n\n    // Confirm password validation\n    if (!formData.confirmPassword) {\n      newErrors.confirmPassword = 'Please confirm your password';\n    } else if (formData.password !== formData.confirmPassword) {\n      newErrors.confirmPassword = 'Passwords do not match';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  /**\n   * Handle form submission\n   */\n  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n\n    // Check token exists\n    if (!token) {\n      setErrors({\n        submit: 'Invalid or missing reset token. Please request a new password reset.',\n      });\n      return;\n    }\n\n    // Clear previous submit errors\n    setErrors((prev) => ({ ...prev, submit: undefined }));\n\n    // Validate form\n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      // Confirm password reset\n      await authService.confirmPasswordReset({\n        token,\n        newPassword: formData.password,\n      });\n\n      // Show success message\n      setIsSuccess(true);\n\n      // Redirect to login immediately after success\n      // User will see success message briefly before redirect\n      navigate('/login');\n    } catch (error) {\n      // Handle error\n      setErrors({\n        submit:\n          error instanceof Error\n            ? error.message\n            : 'Failed to reset password. The token may be expired.',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /**\n   * Handle input change\n   */\n  const handleChange = (field: keyof ResetPasswordFormData) => (\n    e: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    setFormData((prev) => ({\n      ...prev,\n      [field]: e.target.value,\n    }));\n\n    // Clear field error on change\n    if (errors[field]) {\n      setErrors((prev) => ({\n        ...prev,\n        [field]: undefined,\n      }));\n    }\n  };\n\n  return (\n    <div className={styles['reset-password-page']}>\n      <div className={styles['reset-password-container']}>\n        <div className={styles['reset-password-header']}>\n          <Heading level=\"h1\" align=\"center\" gutterBottom={false}>\n            Reset Password\n          </Heading>\n          <p className={styles['reset-password-subtitle']}>\n            Enter your new password below\n          </p>\n        </div>\n\n        <Card variant=\"elevated\" padding=\"large\">\n          {isSuccess ? (\n            // Success confirmation\n            <div className={styles['reset-password-success']}>\n              <div className={styles['success-icon']} aria-hidden=\"true\">\n                <svg width=\"64\" height=\"64\" viewBox=\"0 0 64 64\" fill=\"none\">\n                  <circle cx=\"32\" cy=\"32\" r=\"32\" fill=\"#dcfce7\" />\n                  <path\n                    d=\"M20 32L28 40L44 24\"\n                    stroke=\"#16a34a\"\n                    strokeWidth=\"4\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                </svg>\n              </div>\n\n              <Heading level=\"h2\" align=\"center\" gutterBottom={true}>\n                Password Reset Successful\n              </Heading>\n\n              <p className={styles['success-message']}>\n                Your password has been successfully reset. You can now sign in with your new\n                password.\n              </p>\n\n              <p className={styles['success-note']}>\n                Redirecting to login page in 3 seconds...\n              </p>\n\n              <Link to=\"/login\" className={styles['go-to-login']}>\n                <Button variant=\"primary\" size=\"large\" fullWidth>\n                  Go to Login\n                </Button>\n              </Link>\n            </div>\n          ) : (\n            // Reset form\n            <form\n              onSubmit={handleSubmit}\n              className={styles['reset-password-form']}\n              noValidate\n            >\n              {/* Submit Error Message */}\n              {errors.submit && (\n                <div className={styles['reset-password-error-banner']} role=\"alert\">\n                  {errors.submit}\n                  <div style={{ marginTop: '12px' }}>\n                    <Link to=\"/forgot-password\" className={styles['reset-password-link']}>\n                      Request a new password reset\n                    </Link>\n                  </div>\n                </div>\n              )}\n\n              {/* Password Input */}\n              <Input\n                type=\"password\"\n                label=\"New Password\"\n                placeholder=\"Enter your new password\"\n                value={formData.password}\n                onChange={handleChange('password')}\n                error={errors.password}\n                required\n                autoComplete=\"new-password\"\n                autoFocus\n                disabled={isLoading || !token}\n              />\n\n              {/* Confirm Password Input */}\n              <Input\n                type=\"password\"\n                label=\"Confirm Password\"\n                placeholder=\"Re-enter your new password\"\n                value={formData.confirmPassword}\n                onChange={handleChange('confirmPassword')}\n                error={errors.confirmPassword}\n                required\n                autoComplete=\"new-password\"\n                disabled={isLoading || !token}\n              />\n\n              {/* Password Requirements */}\n              <div className={styles['password-requirements']}>\n                <p className={styles['requirements-title']}>Password must contain:</p>\n                <ul className={styles['requirements-list']}>\n                  <li>At least 8 characters</li>\n                  <li>One uppercase letter</li>\n                  <li>One lowercase letter</li>\n                  <li>One number</li>\n                </ul>\n              </div>\n\n              {/* Submit Button */}\n              <Button\n                type=\"submit\"\n                variant=\"primary\"\n                size=\"large\"\n                fullWidth\n                loading={isLoading}\n                disabled={isLoading || !token}\n              >\n                {isLoading ? 'Resetting Password...' : 'Reset Password'}\n              </Button>\n\n              {/* Back to Login Link */}\n              <div className={styles['reset-password-footer']}>\n                <Link to=\"/login\" className={styles['reset-password-link']}>\n                  ‚Üê Back to Login\n                </Link>\n              </div>\n            </form>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n};\n"],"names":["ResetPasswordPage","navigate","useNavigate","searchParams","useSearchParams","token","formData","setFormData","useState","errors","setErrors","isLoading","setIsLoading","isSuccess","setIsSuccess","useEffect","validateForm","newErrors","handleSubmit","e","prev","authService","error","handleChange","field","jsx","styles","jsxs","Heading","Card","Link","Button","Input"],"mappings":"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"}