{"version":3,"file":"analyticsService-BS3kiGOL.js","sources":["../../src/services/analyticsService.ts"],"sourcesContent":["/**\n * Analytics Service\n *\n * BUSINESS CONTEXT:\n * Handles analytics and reporting for corporate IT training metrics.\n * Provides data for dashboards, compliance reports, and performance tracking.\n * Supports trainer analytics, student progress tracking, and organizational metrics.\n *\n * TECHNICAL IMPLEMENTATION:\n * - Uses centralized apiClient with authentication\n * - Provides metrics for all user roles (student, instructor, org_admin, site_admin)\n * - Handles time-series data and aggregated statistics\n * - Integrates with analytics service (port 8004)\n */\n\nimport { apiClient } from './apiClient';\n\n/**\n * Student Analytics\n * Metrics for individual student performance\n */\nexport interface StudentAnalytics {\n  student_id: string;\n  student_name?: string;\n  total_courses: number;\n  completed_courses: number;\n  active_courses: number;\n  average_progress: number;\n  average_completion_rate: number;\n  total_labs_completed: number;\n  certificates_earned: number;\n  total_learning_time_hours: number;\n  last_activity_date?: string;\n  engagement_score: number;\n}\n\n/**\n * Training Program Analytics\n * Metrics for course performance and effectiveness\n */\nexport interface TrainingProgramAnalytics {\n  course_id: string;\n  course_title?: string;\n  total_enrollments: number;\n  active_students: number;\n  completed_students: number;\n  average_completion_rate: number;\n  average_progress: number;\n  average_rating?: number;\n  total_feedback_count: number;\n  dropout_rate: number;\n  average_completion_time_days: number;\n}\n\n/**\n * Instructor Analytics\n * Metrics for corporate trainer performance\n */\nexport interface InstructorAnalytics {\n  instructor_id: string;\n  instructor_name?: string;\n  total_programs: number;\n  published_programs: number;\n  total_students: number;\n  active_students: number;\n  average_completion_rate: number;\n  average_course_rating?: number;\n  total_content_generated: number;\n  engagement_score: number;\n}\n\n/**\n * Organization Analytics\n * Metrics for corporate training at organization level\n */\nexport interface OrganizationAnalytics {\n  organization_id: string;\n  organization_name?: string;\n  total_students: number;\n  active_students: number;\n  total_trainers: number;\n  active_trainers: number;\n  total_training_programs: number;\n  published_programs: number;\n  total_enrollments: number;\n  average_completion_rate: number;\n  certificates_issued: number;\n  compliance_score: number;\n  engagement_rate: number;\n}\n\n/**\n * Dashboard Statistics\n * Quick stats for dashboard widgets\n */\nexport interface DashboardStats {\n  assigned_courses?: number;\n  enrolled_students?: number;\n  training_programs?: number;\n  total_students?: number;\n  total_organizations?: number;\n  total_users?: number;\n  active_users?: number;\n  average_progress?: number;\n  completion_rate?: number;\n  labs_completed?: number;\n  certificates_earned?: number;\n  engagement_rate?: number;\n  system_uptime?: number;\n  monthly_revenue?: number;\n}\n\n/**\n * Time Series Data Point\n * For charts and graphs\n */\nexport interface TimeSeriesDataPoint {\n  date: string;\n  value: number;\n  label?: string;\n}\n\n/**\n * Analytics Time Range\n */\nexport type TimeRange = '7d' | '30d' | '90d' | '1y' | 'all';\n\n/**\n * Analytics Service Class\n *\n * WHY THIS APPROACH:\n * - Centralized analytics API logic\n * - Supports all user roles with role-specific metrics\n * - Type-safe interfaces for dashboard data\n * - Handles time-series data for charts\n */\nclass AnalyticsService {\n  private baseUrl = '/analytics';\n\n  /**\n   * Get student analytics (for student dashboard)\n   */\n  async getStudentAnalytics(studentId: string): Promise<StudentAnalytics> {\n    return await apiClient.get<StudentAnalytics>(`${this.baseUrl}/student/${studentId}`);\n  }\n\n  /**\n   * Get current student's analytics (for logged-in student)\n   */\n  async getMyAnalytics(): Promise<StudentAnalytics> {\n    return await apiClient.get<StudentAnalytics>(`${this.baseUrl}/student/me`);\n  }\n\n  /**\n   * Get training program analytics (for instructor dashboard)\n   */\n  async getTrainingProgramAnalytics(courseId: string): Promise<TrainingProgramAnalytics> {\n    return await apiClient.get<TrainingProgramAnalytics>(`${this.baseUrl}/course/${courseId}`);\n  }\n\n  /**\n   * Get instructor analytics (for instructor dashboard)\n   */\n  async getInstructorAnalytics(instructorId: string): Promise<InstructorAnalytics> {\n    return await apiClient.get<InstructorAnalytics>(`${this.baseUrl}/instructor/${instructorId}`);\n  }\n\n  /**\n   * Get current instructor's analytics\n   */\n  async getMyInstructorAnalytics(): Promise<InstructorAnalytics> {\n    return await apiClient.get<InstructorAnalytics>(`${this.baseUrl}/instructor/me`);\n  }\n\n  /**\n   * Get organization analytics (for org admin dashboard)\n   */\n  async getOrganizationAnalytics(organizationId: string): Promise<OrganizationAnalytics> {\n    return await apiClient.get<OrganizationAnalytics>(`${this.baseUrl}/organization/${organizationId}`);\n  }\n\n  /**\n   * Get dashboard stats for current user\n   * (Returns role-appropriate stats based on user role)\n   */\n  async getDashboardStats(): Promise<DashboardStats> {\n    return await apiClient.get<DashboardStats>(`${this.baseUrl}/dashboard/stats`);\n  }\n\n  /**\n   * Get platform-wide analytics (for site admin dashboard)\n   */\n  async getPlatformAnalytics(): Promise<OrganizationAnalytics> {\n    return await apiClient.get<OrganizationAnalytics>(`${this.baseUrl}/platform`);\n  }\n\n  /**\n   * Get progress over time (for charts)\n   */\n  async getProgressTimeSeries(\n    entityType: 'student' | 'course' | 'organization' | 'platform',\n    entityId: string,\n    timeRange: TimeRange = '30d'\n  ): Promise<TimeSeriesDataPoint[]> {\n    return await apiClient.get<TimeSeriesDataPoint[]>(\n      `${this.baseUrl}/${entityType}/${entityId}/progress-timeline`,\n      { params: { range: timeRange } }\n    );\n  }\n\n  /**\n   * Get enrollment trends over time\n   */\n  async getEnrollmentTrends(\n    organizationId?: string,\n    timeRange: TimeRange = '30d'\n  ): Promise<TimeSeriesDataPoint[]> {\n    const params = { range: timeRange, organization_id: organizationId };\n    return await apiClient.get<TimeSeriesDataPoint[]>(\n      `${this.baseUrl}/enrollments/trends`,\n      { params }\n    );\n  }\n\n  /**\n   * Get completion trends over time\n   */\n  async getCompletionTrends(\n    organizationId?: string,\n    timeRange: TimeRange = '30d'\n  ): Promise<TimeSeriesDataPoint[]> {\n    const params = { range: timeRange, organization_id: organizationId };\n    return await apiClient.get<TimeSeriesDataPoint[]>(\n      `${this.baseUrl}/completions/trends`,\n      { params }\n    );\n  }\n\n  /**\n   * Get compliance report (for org admin)\n   */\n  async getComplianceReport(organizationId: string): Promise<any> {\n    return await apiClient.get(`${this.baseUrl}/organization/${organizationId}/compliance`);\n  }\n\n  /**\n   * Export analytics report\n   */\n  async exportReport(\n    reportType: 'student' | 'instructor' | 'organization' | 'platform',\n    entityId: string,\n    format: 'pdf' | 'csv' | 'excel' = 'pdf'\n  ): Promise<Blob> {\n    return await apiClient.get(\n      `${this.baseUrl}/${reportType}/${entityId}/export`,\n      {\n        params: { format },\n        responseType: 'blob',\n      }\n    );\n  }\n}\n\n// Export singleton instance\nexport const analyticsService = new AnalyticsService();\n"],"names":["AnalyticsService","studentId","apiClient","courseId","instructorId","organizationId","entityType","entityId","timeRange","params","reportType","format","analyticsService"],"mappings":"wCAwIA,MAAMA,CAAiB,CACb,QAAU,aAKlB,MAAM,oBAAoBC,EAA8C,CACtE,OAAO,MAAMC,EAAU,IAAsB,GAAG,KAAK,OAAO,YAAYD,CAAS,EAAE,CACrF,CAKA,MAAM,gBAA4C,CAChD,OAAO,MAAMC,EAAU,IAAsB,GAAG,KAAK,OAAO,aAAa,CAC3E,CAKA,MAAM,4BAA4BC,EAAqD,CACrF,OAAO,MAAMD,EAAU,IAA8B,GAAG,KAAK,OAAO,WAAWC,CAAQ,EAAE,CAC3F,CAKA,MAAM,uBAAuBC,EAAoD,CAC/E,OAAO,MAAMF,EAAU,IAAyB,GAAG,KAAK,OAAO,eAAeE,CAAY,EAAE,CAC9F,CAKA,MAAM,0BAAyD,CAC7D,OAAO,MAAMF,EAAU,IAAyB,GAAG,KAAK,OAAO,gBAAgB,CACjF,CAKA,MAAM,yBAAyBG,EAAwD,CACrF,OAAO,MAAMH,EAAU,IAA2B,GAAG,KAAK,OAAO,iBAAiBG,CAAc,EAAE,CACpG,CAMA,MAAM,mBAA6C,CACjD,OAAO,MAAMH,EAAU,IAAoB,GAAG,KAAK,OAAO,kBAAkB,CAC9E,CAKA,MAAM,sBAAuD,CAC3D,OAAO,MAAMA,EAAU,IAA2B,GAAG,KAAK,OAAO,WAAW,CAC9E,CAKA,MAAM,sBACJI,EACAC,EACAC,EAAuB,MACS,CAChC,OAAO,MAAMN,EAAU,IACrB,GAAG,KAAK,OAAO,IAAII,CAAU,IAAIC,CAAQ,qBACzC,CAAE,OAAQ,CAAE,MAAOC,EAAU,CAAE,CAEnC,CAKA,MAAM,oBACJH,EACAG,EAAuB,MACS,CAChC,MAAMC,EAAS,CAAE,MAAOD,EAAW,gBAAiBH,CAAA,EACpD,OAAO,MAAMH,EAAU,IACrB,GAAG,KAAK,OAAO,sBACf,CAAE,OAAAO,CAAA,CAAO,CAEb,CAKA,MAAM,oBACJJ,EACAG,EAAuB,MACS,CAChC,MAAMC,EAAS,CAAE,MAAOD,EAAW,gBAAiBH,CAAA,EACpD,OAAO,MAAMH,EAAU,IACrB,GAAG,KAAK,OAAO,sBACf,CAAE,OAAAO,CAAA,CAAO,CAEb,CAKA,MAAM,oBAAoBJ,EAAsC,CAC9D,OAAO,MAAMH,EAAU,IAAI,GAAG,KAAK,OAAO,iBAAiBG,CAAc,aAAa,CACxF,CAKA,MAAM,aACJK,EACAH,EACAI,EAAkC,MACnB,CACf,OAAO,MAAMT,EAAU,IACrB,GAAG,KAAK,OAAO,IAAIQ,CAAU,IAAIH,CAAQ,UACzC,CACE,OAAQ,CAAE,OAAAI,CAAA,EACV,aAAc,MAAA,CAChB,CAEJ,CACF,CAGO,MAAMC,EAAmB,IAAIZ"}