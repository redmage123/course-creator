/**
 * the design system Navigation System
 *
 * BUSINESS CONTEXT:
 * Navigation is the primary interface for users to explore and interact with
 * dashboards. A well-designed navigation system reduces cognitive load, improves
 * task completion speed, and creates a professional, polished experience.
 *
 * WHY WE'RE DOING THIS:
 * 1. Clear Visual Hierarchy: Users instantly understand where they are and where they can go
 * 2. Smooth Interactions: 200ms transitions feel responsive without being jarring
 * 3. Active State Clarity: Users never feel lost or confused about their current location
 * 4. Accessibility: Keyboard navigation and ARIA labels ensure inclusive design
 * 5. Responsive Design: Works seamlessly across desktop, tablet, and mobile devices
 * 6. Brand Consistency: Uses OUR blue (#2563eb), NOT Our purple/orange
 *
 * Modern PATTERNS:
 * 1. Subtle hover states (don't overpower content)
 * 2. Clear active indicators (left border + background tint)
 * 3. Icon-text alignment with consistent spacing
 * 4. Collapsible sidebar for screen space control
 * 5. Badge notifications for updates
 * 6. Smooth dropdown animations
 * 7. Mobile-first responsive breakpoints
 *
 * CRITICAL REQUIREMENTS:
 * - Active states use #2563eb (OUR blue), NOT #3E215B (the design system purple)
 * - All spacing uses 8px increments (the design system spacing system)
 * - All transitions are 200ms (consistent timing)
 * - Feature flag scoped: * - Keyboard accessible (focus indicators, tab navigation)
 * - WCAG 2.1 AA+ compliant
 *
 * SOLID PRINCIPLES APPLIED:
 * - Single Responsibility: Each CSS class has one clear purpose
 * - Open/Closed: Extensible through composition, not modification
 * - Liskov Substitution: Navigation works consistently across all dashboards
 * - Interface Segregation: Separate classes for hover, active, focus states
 * - Dependency Inversion: Depends on design tokens (abstractions), not hardcoded values
 */

/* ============================================================================
 * FEATURE FLAG SCOPING
 * ============================================================================
 * All the design system navigation styles ONLY apply when data-the design system-ui="enabled".
 * This ensures backward compatibility and allows gradual rollout.
 */

/* ============================================================================
 * SIDEBAR NAVIGATION CONTAINER
 * ============================================================================
 * Main sidebar container with fixed positioning and proper layering.
 */
[data-the design system-sidebar] {
    /* Layout */
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    width: 280px;

    /* Appearance */
    background: var(--card-background, #ffffff);
    border-right: 1px solid var(--border-color, #e2e8f0);

    /* Spacing (8px system) */
    padding: var(--ui-space-3, 24px) 0;

    /* Z-index for proper layering */
    z-index: 100;

    /* Smooth transitions for collapse */
    transition: width var(--ui-transition-normal, 200ms) var(--ui-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));

    /* Overflow for scrollable content */
    overflow-y: auto;
    overflow-x: hidden;

    /* ACCESSIBILITY: Role should be "navigation" in HTML */
}

/* Collapsed state */
[data-the design system-sidebar][data-collapsed="true"] {
    width: 80px; /* Icon-only mode */
}

/* Hide text labels when collapsed */
[data-the design system-sidebar][data-collapsed="true"] [data-the design system-nav-text] {
    opacity: 0;
    width: 0;
    overflow: hidden;
}

/* ============================================================================
 * NAVIGATION ITEMS (Primary Pattern)
 * ============================================================================
 * Individual navigation items with hover, active, and focus states.
 */
[data-the design system-nav-item] {
    /* Layout */
    display: flex;
    align-items: center;
    gap: var(--ui-space-1, 8px); /* Icon-text spacing */

    /* Spacing (8px system) */
    padding: var(--ui-space-2, 16px) var(--ui-space-3, 24px);
    margin: 0 var(--ui-space-1, 8px);

    /* Typography */
    font-family: var(--ui-font-sans, 'Inter', sans-serif);
    font-size: var(--ui-text-base, 15px);
    font-weight: 500;
    color: var(--text-color, #334155);
    text-decoration: none;

    /* Appearance */
    border-radius: var(--ui-radius-md, 8px);
    background: transparent;
    border-left: 3px solid transparent;

    /* Transitions */
    transition: all var(--ui-transition-normal, 200ms) var(--ui-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));

    /* Cursor */
    cursor: pointer;

    /* BUSINESS RATIONALE:
     * Flexbox with gap ensures consistent icon-text spacing.
     * 16px vertical padding provides comfortable touch targets (44px+ height).
     * Border-radius follows Our modern, subtle rounding pattern.
     */
}

/* Hover state - Subtle background change */
[data-the design system-nav-item]:hover {
    background: var(--ui-color-gray-100, #f1f5f9);
    transform: translateX(2px); /* Subtle right shift */

    /* BUSINESS RATIONALE:
     * Subtle background change provides feedback without being overwhelming.
     * 2px translateX gives gentle movement that feels natural.
     */
}

/* Active state - OUR BLUE (CRITICAL) */
[data-the design system-nav-item][data-active="true"] {
    background: rgba(37, 99, 235, 0.08); /* 8% opacity of #2563eb */
    border-left-color: var(--ui-color-primary, #2563eb); /* OUR blue */
    color: var(--ui-color-primary, #2563eb);
    font-weight: 600;

    /* CRITICAL REQUIREMENT:
     * MUST use #2563eb (OUR blue), NOT #3E215B (the design system purple).
     * This is non-negotiable for brand consistency.
     */
}

/* Focus state - Keyboard accessibility */
[data-the design system-nav-item]:focus {
    outline: 2px solid var(--ui-color-primary, #2563eb);
    outline-offset: 2px;

    /* ACCESSIBILITY REQUIREMENT:
     * Visible focus indicator required for WCAG 2.1 Level AA.
     * 2px outline with offset ensures visibility against all backgrounds.
     */
}

/* Focus visible (modern approach) */
[data-the design system-nav-item]:focus-visible {
    outline: 2px solid var(--ui-color-primary, #2563eb);
    outline-offset: 2px;
}

/* Remove focus outline on mouse click (not keyboard) */
[data-the design system-nav-item]:focus:not(:focus-visible) {
    outline: none;
}

/* ============================================================================
 * NAVIGATION ICONS
 * ============================================================================
 * Icon styling and alignment within navigation items.
 */
[data-the design system-nav-icon] {
    /* Size */
    width: 20px;
    height: 20px;
    flex-shrink: 0; /* Prevent icon from shrinking */

    /* Alignment */
    display: flex;
    align-items: center;
    justify-content: center;

    /* Color inheritance */
    color: inherit;

    /* BUSINESS RATIONALE:
     * 20px is optimal size for readability without dominating.
     * Flex-shrink prevents icon distortion when text wraps.
     */
}

/* Icon in active state */
[data-the design system-nav-item][data-active="true"] [data-the design system-nav-icon] {
    color: var(--ui-color-primary, #2563eb);
}

/* ============================================================================
 * BADGE NOTIFICATIONS
 * ============================================================================
 * Small badge indicators for notifications, counts, or status.
 */
[data-the design system-badge] {
    /* Layout */
    display: inline-flex;
    align-items: center;
    justify-content: center;

    /* Size */
    min-width: 20px;
    height: 20px;
    padding: 0 6px;

    /* Typography */
    font-size: 11px;
    font-weight: 600;
    color: white;

    /* Appearance */
    background: var(--ui-color-danger, #dc2626);
    border-radius: 10px; /* Circular */

    /* Positioning */
    margin-left: auto; /* Push to right */

    /* BUSINESS RATIONALE:
     * Red background draws attention to important updates.
     * Circular shape is recognizable pattern for badges.
     * min-width ensures readability even with single digits.
     */
}

/* ============================================================================
 * SIDEBAR COLLAPSE TOGGLE BUTTON
 * ============================================================================
 * Button to collapse/expand sidebar for screen space control.
 */
[data-the design system-sidebar-toggle] {
    /* Layout */
    display: flex;
    align-items: center;
    justify-content: center;

    /* Size */
    width: 32px;
    height: 32px;

    /* Positioning */
    position: absolute;
    top: var(--ui-space-3, 24px);
    right: var(--ui-space-3, 24px);

    /* Appearance */
    background: transparent;
    border: 1px solid var(--border-color, #e2e8f0);
    border-radius: var(--ui-radius-sm, 4px);
    color: var(--text-color, #334155);
    cursor: pointer;

    /* Transitions */
    transition: all var(--ui-transition-normal, 200ms) var(--ui-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));

    /* BUSINESS RATIONALE:
     * Toggle button gives users control over screen space.
     * Positioned in top-right for easy access.
     */
}

[data-the design system-sidebar-toggle]:hover {
    background: var(--ui-color-gray-100, #f1f5f9);
    border-color: var(--ui-color-gray-500, #64748b);
}

/* ============================================================================
 * BREADCRUMB NAVIGATION
 * ============================================================================
 * Hierarchical navigation showing user's location in app.
 */
[data-the design system-breadcrumb] {
    /* Layout */
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--ui-space-1, 8px);

    /* Spacing */
    padding: var(--ui-space-2, 16px);

    /* BUSINESS RATIONALE:
     * Breadcrumbs provide context and enable quick navigation up hierarchy.
     * Flexbox with gap ensures consistent spacing between items.
     */
}

[data-the design system-breadcrumb-item] {
    /* Typography */
    font-size: var(--ui-text-sm, 13px);
    color: var(--text-color-secondary, #64748b);
    text-decoration: none;

    /* Transitions */
    transition: color var(--ui-transition-fast, 100ms);
}

[data-the design system-breadcrumb-item]:hover {
    color: var(--ui-color-primary, #2563eb);
}

/* Active breadcrumb item */
[data-the design system-breadcrumb-item][data-active="true"] {
    color: var(--text-color, #334155);
    font-weight: 600;
    pointer-events: none;
}

/* Breadcrumb separator */
[data-the design system-breadcrumb-separator] {
    color: var(--ui-color-gray-500, #64748b);
    user-select: none;
}

/* ============================================================================
 * DROPDOWN MENUS
 * ============================================================================
 * Secondary navigation dropdowns with smooth animations.
 */
[data-the design system-dropdown-menu] {
    /* Layout */
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;

    /* Appearance */
    background: var(--card-background, #ffffff);
    border: 1px solid var(--border-color, #e2e8f0);
    border-radius: var(--ui-radius-md, 8px);
    box-shadow: var(--ui-shadow-lg, 0 10px 25px rgba(0, 0, 0, 0.15));

    /* Spacing */
    padding: var(--ui-space-1, 8px) 0;
    margin-top: var(--ui-space-1, 8px);

    /* Z-index for layering */
    z-index: 200;

    /* Animations */
    opacity: 0;
    transform: translateY(-8px);
    transition:
        opacity var(--ui-transition-normal, 200ms) var(--ui-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1)),
        transform var(--ui-transition-normal, 200ms) var(--ui-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));

    /* Initially hidden */
    display: none;

    /* BUSINESS RATIONALE:
     * Shadow creates depth perception and separates dropdown from background.
     * Transform animation (slide-down) feels natural and polished.
     */
}

/* Show dropdown */
[data-the design system-dropdown-trigger]:hover [data-the design system-dropdown-menu],
[data-the design system-dropdown-trigger]:focus-within [data-the design system-dropdown-menu],
[data-the design system-dropdown-menu][data-open="true"] {
    display: block;
    opacity: 1;
    transform: translateY(0);
}

/* Dropdown items */
[data-the design system-dropdown-menu] a,
[data-the design system-dropdown-menu] button {
    /* Layout */
    display: block;
    width: 100%;
    text-align: left;

    /* Spacing */
    padding: var(--ui-space-2, 16px) var(--ui-space-3, 24px);

    /* Typography */
    font-size: var(--ui-text-base, 15px);
    color: var(--text-color, #334155);
    text-decoration: none;

    /* Appearance */
    background: transparent;
    border: none;
    cursor: pointer;

    /* Transitions */
    transition: background var(--ui-transition-fast, 100ms);
}

[data-the design system-dropdown-menu] a:hover,
[data-the design system-dropdown-menu] button:hover {
    background: var(--ui-color-gray-100, #f1f5f9);
}

/* ============================================================================
 * MOBILE HAMBURGER MENU
 * ============================================================================
 * Responsive hamburger button for mobile navigation.
 */
[data-the design system-hamburger] {
    /* Initially hidden (desktop-first) */
    display: none;

    /* Layout */
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;

    /* Size */
    width: 40px;
    height: 40px;

    /* Appearance */
    background: transparent;
    border: 1px solid var(--border-color, #e2e8f0);
    border-radius: var(--ui-radius-sm, 4px);
    cursor: pointer;

    /* Positioning */
    position: fixed;
    top: var(--ui-space-2, 16px);
    left: var(--ui-space-2, 16px);
    z-index: 300;

    /* Transitions */
    transition: all var(--ui-transition-normal, 200ms);

    /* BUSINESS RATIONALE:
     * Hamburger menu is standard mobile pattern.
     * Fixed positioning ensures always accessible.
     */
}

/* Hamburger bars */
[data-the design system-hamburger] span {
    display: block;
    width: 20px;
    height: 2px;
    background: var(--text-color, #334155);
    transition: all var(--ui-transition-normal, 200ms);
}

/* Hamburger hover state */
[data-the design system-hamburger]:hover {
    background: var(--ui-color-gray-100, #f1f5f9);
}

/* ============================================================================
 * MOBILE RESPONSIVE STYLES
 * ============================================================================
 * Breakpoint-specific styles for tablets and mobile devices.
 */

/* Tablet (< 1024px) */
@media (max-width: 1024px) {
    [data-the design system-sidebar] {
        width: 240px; /* Narrower sidebar */
    }
}

/* Mobile (< 768px) */
@media (max-width: 768px) {
    /* Show hamburger menu */
    [data-the design system-hamburger] {
        display: flex;
    }

    /* Hide sidebar by default */
    [data-the design system-sidebar] {
        transform: translateX(-100%);
    }

    /* Show sidebar when mobile menu open */
    [data-the design system-sidebar][data-mobile-open="true"] {
        transform: translateX(0);
    }

    /* Overlay backdrop when sidebar open */
    [data-the design system-sidebar]::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: -1;
        opacity: 0;
        transition: opacity var(--ui-transition-normal, 200ms);
    }

    [data-the design system-sidebar][data-mobile-open="true"]::before {
        opacity: 1;
    }
}

/* ============================================================================
 * ACCESSIBILITY ENHANCEMENTS
 * ============================================================================
 * Additional styles for screen readers and keyboard navigation.
 */

/* Skip to main content link (for screen readers) */
[data-the design system-skip-link] {
    position: absolute;
    left: -9999px;
    top: 0;
    z-index: 999;
    padding: var(--ui-space-2, 16px);
    background: var(--ui-color-primary, #2563eb);
    color: white;
    text-decoration: none;
}

[data-the design system-skip-link]:focus {
    left: 0;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    [data-the design system-nav-item] {
        border: 1px solid currentColor;
    }

    [data-the design system-nav-item]:focus {
        outline-width: 3px;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    [data-the design system-sidebar],
    [data-the design system-nav-item],
    [data-the design system-dropdown-menu],
    [data-the design system-hamburger] span {
        transition: none;
    }
}

/* ============================================================================
 * PRINT STYLES
 * ============================================================================
 * Ensure navigation doesn't waste paper when printing.
 */
@media print {
    [data-the design system-sidebar],
    [data-the design system-hamburger] {
        display: none;
    }
}

/**
 * ============================================================================
 * IMPLEMENTATION NOTES FOR DEVELOPERS
 * ============================================================================
 *
 * USAGE EXAMPLE:
 *
 * <nav data-the design system-sidebar role="navigation" aria-label="Main navigation">
 *     <button data-the design system-sidebar-toggle aria-label="Toggle sidebar">â˜°</button>
 *
 *     <a href="#" data-the design system-nav-item data-active="true" aria-current="page">
 *         <span data-the design system-nav-icon>ðŸ“Š</span>
 *         <span data-the design system-nav-text>Dashboard</span>
 *     </a>
 *
 *     <a href="#" data-the design system-nav-item>
 *         <span data-the design system-nav-icon>ðŸ“š</span>
 *         <span data-the design system-nav-text>Courses</span>
 *         <span data-the design system-badge>3</span>
 *     </a>
 * </nav>
 *
 * CRITICAL REMINDERS:
 * 1. Always use OUR blue (#2563eb) for active states, NOT the design system purple
 * 2. All spacing must be multiples of 8px (use design tokens)
 * 3. All transitions must be 200ms (use --ui-transition-normal)
 * 4. Include ARIA labels for accessibility
 * 5. Test with keyboard navigation (Tab, Enter, Arrow keys)
 * 6. Test on mobile devices (< 768px)
 *
 * TESTING:
 * Run: pytest tests/the design system/e2e/test_the design system_navigation.py -v
 *
 * ============================================================================
 */
