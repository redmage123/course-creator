/**
 * Modern Modal/Dialog System
 *
 * Comprehensive modal system with smooth animations, accessibility features,
 * and OUR blue color scheme (#2563eb), NOT Our purple/orange.
 *
 * Features:
 * - Smooth 200ms fade-in/out animations
 * - Backdrop with blur effect
 * - Multiple sizes: sm (400px), md (600px), lg (800px), xl (1000px)
 * - Keyboard navigation (ESC to close)
 * - Click outside to close
 * - Focus trap for accessibility
 * - Body scroll lock when open
 * - 8px spacing system
 * - 12px border radius (--ui-radius-lg)
 *
 * Usage:
 * <div class="the design system-modal" role="dialog">
 *   <div class="the design system-modal-backdrop"></div>
 *   <div class="the design system-modal-content the design system-modal-md">
 *     <div class="the design system-modal-header">...</div>
 *     <div class="the design system-modal-body">...</div>
 *     <div class="the design system-modal-footer">...</div>
 *   </div>
 * </div>
 */

/* ============================= */
/* Modal Container & Backdrop    */
/* ============================= */

.the design system-modal {
  /* Positioning - full screen overlay */
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1000; /* Higher than navigation */

  /* Layout - centered content */
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--ui-spacing-xl, 32px); /* 4 * 8px */

  /* Initially hidden */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;

  /* Smooth fade-in/out animation - 200ms */
  transition: opacity var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out),
              visibility var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out);
}

.the design system-modal.is-open {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* Backdrop with blur effect */
.the design system-modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--ui-overlay-bg, rgba(0, 0, 0, 0.4));
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  z-index: 0; /* Below modal content but still clickable */
}

/* ============================= */
/* Modal Content Container       */
/* ============================= */

.the design system-modal-content {
  /* Positioning */
  position: relative;
  z-index: 10; /* Above backdrop */

  /* Layout */
  display: flex;
  flex-direction: column;
  width: 100%;
  max-height: calc(100vh - 64px); /* Leave space for padding */

  /* Visual styling - OUR design tokens */
  background: var(--ui-surface-bg, #ffffff);
  border-radius: var(--ui-radius-lg, 12px);
  box-shadow: var(--ui-shadow-xl, 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04));

  /* Animation - scale in */
  transform: scale(0.95);
  transition: transform var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out);
}

.the design system-modal.is-open .the design system-modal-content {
  transform: scale(1);
}

/* ============================= */
/* Modal Size Variants           */
/* ============================= */

/* Small: 400px */
.the design system-modal-content.the design system-modal-sm {
  max-width: 400px;
}

/* Medium: 600px (default) */
.the design system-modal-content.the design system-modal-md {
  max-width: 600px;
}

/* Large: 800px */
.the design system-modal-content.the design system-modal-lg {
  max-width: 800px;
}

/* Extra Large: 1000px */
.the design system-modal-content.the design system-modal-xl {
  max-width: 1000px;
}

/* ============================= */
/* Modal Header                  */
/* ============================= */

.the design system-modal-header {
  /* Layout */
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--ui-spacing-lg, 24px); /* 3 * 8px */
  border-bottom: 1px solid var(--ui-border-color, #e5e7eb);

  /* Flex behavior */
  flex-shrink: 0;
}

.the design system-modal-header h2 {
  margin: 0;
  font-size: var(--ui-font-size-xl, 20px);
  font-weight: 600;
  color: var(--ui-text-primary, #111827);
  line-height: 1.3;
}

/* Close button */
.the design system-modal-close {
  /* Reset button styles */
  appearance: none;
  border: none;
  background: none;
  padding: var(--ui-spacing-xs, 8px); /* 1 * 8px */
  margin: calc(-1 * var(--ui-spacing-xs, 8px)); /* Negative margin for better clickable area */

  /* Layout */
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;

  /* Visual */
  color: var(--ui-text-secondary, #6b7280);
  border-radius: var(--ui-radius-md, 8px);
  cursor: pointer;

  /* Transition */
  transition: background-color var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out),
              color var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out);
}

.the design system-modal-close:hover {
  background-color: var(--ui-hover-bg, #f3f4f6);
  color: var(--ui-text-primary, #111827);
}

.the design system-modal-close:focus {
  outline: 2px solid var(--ui-primary, #2563eb);
  outline-offset: 2px;
}

.the design system-modal-close svg {
  width: 20px;
  height: 20px;
}

/* ============================= */
/* Modal Body                    */
/* ============================= */

.the design system-modal-body {
  /* Layout */
  padding: var(--ui-spacing-lg, 24px); /* 3 * 8px */
  overflow-y: auto;
  flex: 1 1 auto;

  /* Typography */
  color: var(--ui-text-secondary, #6b7280);
  font-size: var(--ui-font-size-base, 16px);
  line-height: 1.6;
}

/* Custom scrollbar for modal body */
.the design system-modal-body::-webkit-scrollbar {
  width: 8px;
}

.the design system-modal-body::-webkit-scrollbar-track {
  background: var(--ui-surface-secondary, #f9fafb);
  border-radius: var(--ui-radius-sm, 4px);
}

.the design system-modal-body::-webkit-scrollbar-thumb {
  background: var(--ui-border-color, #e5e7eb);
  border-radius: var(--ui-radius-sm, 4px);
}

.the design system-modal-body::-webkit-scrollbar-thumb:hover {
  background: var(--ui-text-tertiary, #9ca3af);
}

/* ============================= */
/* Modal Footer                  */
/* ============================= */

.the design system-modal-footer {
  /* Layout */
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: var(--ui-spacing-md, 16px); /* 2 * 8px */
  padding: var(--ui-spacing-lg, 24px); /* 3 * 8px */
  border-top: 1px solid var(--ui-border-color, #e5e7eb);

  /* Flex behavior */
  flex-shrink: 0;
}

/* ============================= */
/* Modal Buttons                 */
/* ============================= */

/* Primary button - OUR BLUE (#2563eb) */
.the design system-modal-footer .the design system-btn-primary {
  /* Reset */
  appearance: none;
  border: none;

  /* Layout */
  padding: var(--ui-spacing-sm, 12px) var(--ui-spacing-lg, 24px);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--ui-spacing-xs, 8px);

  /* Typography */
  font-size: var(--ui-font-size-base, 16px);
  font-weight: 500;
  line-height: 1.5;
  text-decoration: none;
  white-space: nowrap;

  /* Visual - OUR BLUE (#2563eb) */
  background-color: var(--ui-primary, #2563eb);
  color: #ffffff;
  border-radius: var(--ui-radius-md, 8px);
  box-shadow: var(--ui-shadow-sm, 0 1px 2px 0 rgba(0, 0, 0, 0.05));

  /* Interaction */
  cursor: pointer;
  transition: background-color var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out),
              box-shadow var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out),
              transform var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out);
}

.the design system-modal-footer .the design system-btn-primary:hover {
  background-color: var(--ui-primary-dark, #1d4ed8);
  box-shadow: var(--ui-shadow-md, 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06));
}

.the design system-modal-footer .the design system-btn-primary:active {
  transform: translateY(1px);
}

.the design system-modal-footer .the design system-btn-primary:focus {
  outline: 2px solid var(--ui-primary, #2563eb);
  outline-offset: 2px;
}

/* Secondary button */
.the design system-modal-footer .the design system-btn-secondary {
  /* Reset */
  appearance: none;

  /* Layout */
  padding: var(--ui-spacing-sm, 12px) var(--ui-spacing-lg, 24px);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--ui-spacing-xs, 8px);

  /* Typography */
  font-size: var(--ui-font-size-base, 16px);
  font-weight: 500;
  line-height: 1.5;
  text-decoration: none;
  white-space: nowrap;

  /* Visual */
  background-color: transparent;
  color: var(--ui-text-primary, #111827);
  border: 1px solid var(--ui-border-color, #e5e7eb);
  border-radius: var(--ui-radius-md, 8px);

  /* Interaction */
  cursor: pointer;
  transition: background-color var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out),
              border-color var(--ui-transition-duration, 200ms) var(--ui-transition-timing, ease-in-out);
}

.the design system-modal-footer .the design system-btn-secondary:hover {
  background-color: var(--ui-hover-bg, #f3f4f6);
  border-color: var(--ui-text-tertiary, #9ca3af);
}

.the design system-modal-footer .the design system-btn-secondary:focus {
  outline: 2px solid var(--ui-primary, #2563eb);
  outline-offset: 2px;
}

/* ============================= */
/* Body Scroll Lock              */
/* ============================= */

body[data-the design system-ui="enabled"].the design system-modal-open {
  overflow: hidden !important;
}

/* ============================= */
/* Responsive Design             */
/* ============================= */

@media (max-width: 768px) {
  /* Full-width on mobile with padding */
  .the design system-modal {
    padding: var(--ui-spacing-md, 16px);
  }

  .the design system-modal-content {
    max-width: 100% !important;
    max-height: calc(100vh - 32px);
  }

  /* Adjust padding on mobile */
  .the design system-modal-header,
  .the design system-modal-body,
  .the design system-modal-footer {
    padding: var(--ui-spacing-md, 16px);
  }

  /* Stack footer buttons on very small screens */
  .the design system-modal-footer {
    flex-direction: column-reverse;
  }

  .the design system-modal-footer button {
    width: 100%;
  }
}

@media (max-width: 480px) {
  .the design system-modal {
    padding: var(--ui-spacing-xs, 8px);
  }

  .the design system-modal-content {
    max-height: calc(100vh - 16px);
  }
}

/* ============================= */
/* Print Styles                  */
/* ============================= */

@media print {
  .the design system-modal {
    display: none;
  }
}
