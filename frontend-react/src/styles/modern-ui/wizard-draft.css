/**
 * Wizard Draft System - Styling
 *
 * BUSINESS CONTEXT:
 * Provides visual feedback for draft save/load functionality in multi-step wizards.
 * Users can save progress, resume later, and receive clear feedback about draft state.
 *
 * DESIGN PHILOSOPHY:
 * - Uses OUR blue color scheme (#2563eb)
 * - Integrates with Wave 3 feedback-system.js (toasts)
 * - Integrates with Wave 3 modal-system.js (resume/unsaved modals)
 * - Clear visual hierarchy for primary vs secondary actions
 * - Accessible with proper ARIA support
 *
 * KEY COMPONENTS:
 * 1. Save Draft Button - Gray, secondary styling (not primary blue)
 * 2. Draft Indicator - Blue-bordered info box showing last save time
 * 3. Resume Draft Modal - Choice between resume or start fresh
 * 4. Unsaved Changes Modal - Prevent accidental data loss
 * 5. Dirty State Indicator - Visual cue for unsaved changes
 * 6. Loading States - Button spinners during save operations
 *
 * TECHNICAL NOTES:
 * - All spacing uses 8px system (var(--ui-space-*))
 * - All colors use our blue scheme (var(--ui-color-*))
 * - Animations use consistent timing (var(--ui-transition-*))
 */

/* ============================================================================
 * SAVE DRAFT BUTTON
 * ============================================================================
 * Secondary button style - not primary blue. Indicates optional action.
 */
.wizard-save-draft-btn {
    background: var(--ui-color-gray-100);
    color: var(--ui-color-gray-900);
    border: 1px solid var(--ui-color-gray-200);
    padding: var(--ui-space-2);
    border-radius: var(--ui-radius-sm);
    font-size: var(--ui-text-base);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
    display: inline-flex;
    align-items: center;
    gap: var(--ui-space-1);
}

.wizard-save-draft-btn:hover {
    background: var(--ui-color-gray-200);
    border-color: var(--ui-color-gray-500);
    transform: translateY(-1px);
    box-shadow: var(--ui-shadow-sm);
}

.wizard-save-draft-btn:active {
    transform: translateY(0);
    box-shadow: none;
}

.wizard-save-draft-btn:disabled {
    background: var(--ui-color-gray-100);
    color: var(--ui-color-gray-500);
    cursor: not-allowed;
    opacity: 0.6;
    transform: none;
}

/* Loading state for save button */
.wizard-save-draft-btn.btn-loading {
    position: relative;
    color: transparent;
}

.wizard-save-draft-btn.btn-loading::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    top: 50%;
    left: 50%;
    margin-left: -8px;
    margin-top: -8px;
    border: 2px solid var(--ui-color-gray-500);
    border-radius: 50%;
    border-top-color: transparent;
    animation: wizard-draft-spinner 0.6s linear infinite;
}

@keyframes wizard-draft-spinner {
    to { transform: rotate(360deg); }
}

/* ============================================================================
 * DRAFT INDICATOR
 * ============================================================================
 * Info box showing draft status and last saved time.
 */
.wizard-draft-indicator {
    background: #f0f9ff; /* Light blue background */
    border-left: 4px solid var(--ui-color-primary); /* Our blue #2563eb */
    padding: var(--ui-space-2);
    margin-bottom: var(--ui-space-3);
    border-radius: var(--ui-radius-sm);
    display: flex;
    align-items: center;
    gap: var(--ui-space-2);
    font-size: var(--ui-text-sm);
    color: var(--ui-color-gray-900);
}

.wizard-draft-indicator::before {
    content: '‚ÑπÔ∏è';
    font-size: var(--ui-text-lg);
}

.wizard-draft-indicator[data-draft-indicator] {
    font-weight: 500;
}

/* Hide when no draft exists */
.wizard-draft-indicator.hidden {
    display: none;
}

/* ============================================================================
 * DIRTY STATE INDICATOR
 * ============================================================================
 * Visual cue showing unsaved changes exist.
 */
[data-dirty-indicator] {
    display: inline-flex;
    align-items: center;
    gap: var(--ui-space-1);
    color: var(--ui-color-primary);
    font-size: var(--ui-text-sm);
    font-weight: 500;
    padding: var(--ui-space-1) var(--ui-space-2);
    background: #f0f9ff;
    border-radius: var(--ui-radius-sm);
    margin-left: var(--ui-space-2);
}

[data-dirty-indicator]::before {
    content: '‚Ä¢';
    font-size: var(--ui-text-xl);
    color: var(--ui-color-primary);
}

/* ============================================================================
 * RESUME DRAFT MODAL
 * ============================================================================
 * Modal prompting user to resume or discard draft.
 * Uses base modal styles from modal-system.css.
 */
.wizard-resume-modal {
    /* Inherits from .modal base styles */
}

.wizard-resume-modal .modal-header {
    background: #f0f9ff;
    border-bottom: 1px solid var(--ui-color-gray-200);
}

.wizard-resume-modal .modal-title {
    color: var(--ui-color-gray-900);
    display: flex;
    align-items: center;
    gap: var(--ui-space-2);
}

.wizard-resume-modal .modal-title::before {
    content: 'üíæ';
    font-size: var(--ui-text-2xl);
}

.wizard-resume-modal .modal-body {
    padding: var(--ui-space-4);
}

.wizard-resume-modal .draft-info {
    background: var(--ui-color-gray-50);
    padding: var(--ui-space-3);
    border-radius: var(--ui-radius-sm);
    margin-bottom: var(--ui-space-3);
    border-left: 3px solid var(--ui-color-primary);
}

.wizard-resume-modal .draft-timestamp {
    font-size: var(--ui-text-sm);
    color: var(--ui-color-gray-500);
    margin-top: var(--ui-space-1);
}

.wizard-resume-modal .modal-footer {
    display: flex;
    gap: var(--ui-space-2);
    justify-content: flex-end;
    padding: var(--ui-space-3);
    border-top: 1px solid var(--ui-color-gray-200);
}

/* Resume button - primary action */
.wizard-resume-modal [data-action="resume"] {
    background: var(--ui-color-primary);
    color: white;
    border: none;
    padding: var(--ui-space-2) var(--ui-space-4);
    border-radius: var(--ui-radius-sm);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
}

.wizard-resume-modal [data-action="resume"]:hover {
    background: var(--ui-color-accent);
    transform: translateY(-1px);
    box-shadow: var(--ui-shadow-md);
}

/* Start Fresh button - secondary action */
.wizard-resume-modal [data-action="start-fresh"] {
    background: transparent;
    color: var(--ui-color-gray-500);
    border: 1px solid var(--ui-color-gray-200);
    padding: var(--ui-space-2) var(--ui-space-4);
    border-radius: var(--ui-radius-sm);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
}

.wizard-resume-modal [data-action="start-fresh"]:hover {
    background: var(--ui-color-gray-100);
    border-color: var(--ui-color-gray-500);
}

/* ============================================================================
 * UNSAVED CHANGES MODAL
 * ============================================================================
 * Warning modal when user tries to leave with unsaved changes.
 */
.wizard-unsaved-modal {
    /* Inherits from .modal base styles */
}

.wizard-unsaved-modal .modal-header {
    background: #fef3c7; /* Warning yellow background */
    border-bottom: 1px solid #fbbf24;
}

.wizard-unsaved-modal .modal-title {
    color: #92400e; /* Dark yellow/brown */
    display: flex;
    align-items: center;
    gap: var(--ui-space-2);
}

.wizard-unsaved-modal .modal-title::before {
    content: '‚ö†Ô∏è';
    font-size: var(--ui-text-2xl);
}

.wizard-unsaved-modal .modal-body {
    padding: var(--ui-space-4);
}

.wizard-unsaved-modal .warning-message {
    font-size: var(--ui-text-base);
    color: var(--ui-color-gray-900);
    margin-bottom: var(--ui-space-3);
    line-height: 1.5;
}

.wizard-unsaved-modal .modal-footer {
    display: flex;
    gap: var(--ui-space-2);
    justify-content: flex-end;
    padding: var(--ui-space-3);
    border-top: 1px solid var(--ui-color-gray-200);
}

/* Save & Close button - primary action */
.wizard-unsaved-modal [data-action="save-and-close"] {
    background: var(--ui-color-primary);
    color: white;
    border: none;
    padding: var(--ui-space-2) var(--ui-space-4);
    border-radius: var(--ui-radius-sm);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
}

.wizard-unsaved-modal [data-action="save-and-close"]:hover {
    background: var(--ui-color-accent);
    transform: translateY(-1px);
    box-shadow: var(--ui-shadow-md);
}

/* Discard button - destructive action (red) */
.wizard-unsaved-modal [data-action="discard"] {
    background: transparent;
    color: var(--ui-color-danger);
    border: 1px solid var(--ui-color-danger);
    padding: var(--ui-space-2) var(--ui-space-4);
    border-radius: var(--ui-radius-sm);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
}

.wizard-unsaved-modal [data-action="discard"]:hover {
    background: var(--ui-color-danger);
    color: white;
}

/* Cancel button - secondary action */
.wizard-unsaved-modal [data-action="cancel"] {
    background: transparent;
    color: var(--ui-color-gray-500);
    border: 1px solid var(--ui-color-gray-200);
    padding: var(--ui-space-2) var(--ui-space-4);
    border-radius: var(--ui-radius-sm);
    font-weight: 500;
    cursor: pointer;
    transition: all var(--ui-transition-normal) var(--ui-ease-out);
}

.wizard-unsaved-modal [data-action="cancel"]:hover {
    background: var(--ui-color-gray-100);
    border-color: var(--ui-color-gray-500);
}

/* ============================================================================
 * WIZARD FOOTER WITH DRAFT ACTIONS
 * ============================================================================
 * Layout for wizard footer containing Save Draft and navigation buttons.
 */
.wizard-footer-with-draft {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--ui-space-3);
    border-top: 1px solid var(--ui-color-gray-200);
    background: var(--ui-color-gray-50);
}

.wizard-footer-draft-actions {
    display: flex;
    gap: var(--ui-space-2);
    align-items: center;
}

.wizard-footer-navigation {
    display: flex;
    gap: var(--ui-space-2);
}

/* ============================================================================
 * RESPONSIVE DESIGN
 * ============================================================================
 * Mobile-friendly adaptations for smaller screens.
 */
@media (max-width: 768px) {
    .wizard-footer-with-draft {
        flex-direction: column;
        gap: var(--ui-space-2);
    }

    .wizard-footer-draft-actions,
    .wizard-footer-navigation {
        width: 100%;
        justify-content: center;
    }

    .wizard-save-draft-btn {
        width: 100%;
        justify-content: center;
    }

    .wizard-draft-indicator {
        font-size: var(--ui-text-xs);
        padding: var(--ui-space-1) var(--ui-space-2);
    }

    .wizard-resume-modal .modal-footer,
    .wizard-unsaved-modal .modal-footer {
        flex-direction: column;
    }

    .wizard-resume-modal [data-action],
    .wizard-unsaved-modal [data-action] {
        width: 100%;
        justify-content: center;
    }
}

/* ============================================================================
 * ACCESSIBILITY ENHANCEMENTS
 * ============================================================================
 * Keyboard navigation and screen reader support.
 */

/* Focus styles for all interactive elements */
.wizard-save-draft-btn:focus,
.wizard-resume-modal [data-action]:focus,
.wizard-unsaved-modal [data-action]:focus {
    outline: 2px solid var(--ui-color-primary);
    outline-offset: 2px;
}

/* Screen reader only text */
.wizard-draft-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

/* ============================================================================
 * ANIMATION KEYFRAMES
 * ============================================================================
 * Smooth animations for state transitions.
 */

/* Draft indicator fade in */
@keyframes draft-indicator-fadein {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.wizard-draft-indicator {
    animation: draft-indicator-fadein var(--ui-transition-normal) var(--ui-ease-out);
}

/* Dirty indicator pulse */
@keyframes dirty-pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

[data-dirty-indicator] {
    animation: dirty-pulse 2s ease-in-out infinite;
}

/* ============================================================================
 * PRINT STYLES
 * ============================================================================
 * Hide draft controls when printing.
 */
@media print {
    .wizard-save-draft-btn,
    .wizard-draft-indicator,
    [data-dirty-indicator],
    .wizard-resume-modal,
    .wizard-unsaved-modal {
        display: none !important;
    }
}
